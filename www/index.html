<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIP Files - Customer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: #000;
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        /* ANIMATED SHARINGAN BACKGROUND */
        .sharingan-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }
        
        .sharingan-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 800px;
            height: 800px;
            opacity: 0.3;
        }
        
        .sharingan {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(255,0,0,0.1) 0%, rgba(255,0,0,0) 70%);
            border-radius: 50%;
            animation: rotateSharingan 20s linear infinite;
        }
        
        .sharingan-inner {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 200px;
            border-radius: 50%;
            border: 5px solid rgba(255,0,0,0.5);
            box-shadow: 0 0 30px rgba(255,0,0,0.5);
        }
        
        .sharingan-tomoe {
            position: absolute;
            width: 60px;
            height: 60px;
            background: radial-gradient(circle, rgba(255,0,0,0.8) 0%, rgba(255,0,0,0.2) 70%);
            border-radius: 50%;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .sharingan-tomoe:nth-child(2) {
            transform: translateX(-50%) rotate(120deg);
            transform-origin: 0 200px;
        }
        
        .sharingan-tomoe:nth-child(3) {
            transform: translateX(-50%) rotate(240deg);
            transform-origin: 0 200px;
        }
        
        .sharingan-tomoe::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 15px;
            height: 15px;
            background: #000;
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }
        
        @keyframes rotateSharingan {
            0% {
                transform: translate(-50%, -50%) rotate(0deg);
            }
            100% {
                transform: translate(-50%, -50%) rotate(360deg);
            }
        }
        
        .animated-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 50%, rgba(255,0,0,0.1) 0%, transparent 50%),
                       radial-gradient(circle at 80% 20%, rgba(255,0,0,0.1) 0%, transparent 50%),
                       radial-gradient(circle at 40% 80%, rgba(255,0,0,0.1) 0%, transparent 50%);
            animation: pulseBackground 10s ease-in-out infinite;
        }
        
        @keyframes pulseBackground {
            0%, 100% {
                opacity: 0.3;
            }
            50% {
                opacity: 0.5;
            }
        }
        
        /* SALDO DISPLAY - TOP RIGHT CORNER */
        .saldo-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9990;
            display: none;
        }
        
        .saldo-card {
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.9), rgba(56, 142, 60, 0.9));
            padding: 15px 25px;
            border-radius: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.4);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 15px;
            animation: pulseSaldo 2s infinite;
            min-width: 200px;
        }
        
        @keyframes pulseSaldo {
            0%, 100% {
                box-shadow: 0 8px 25px rgba(76, 175, 80, 0.4);
            }
            50% {
                box-shadow: 0 8px 35px rgba(76, 175, 80, 0.6);
            }
        }
        
        .saldo-icon {
            font-size: 24px;
            color: white;
            background: rgba(255, 255, 255, 0.2);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .saldo-info {
            flex: 1;
        }
        
        .saldo-label {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 5px;
        }
        
        .saldo-amount {
            font-size: 24px;
            font-weight: bold;
            color: white;
            font-family: monospace;
        }
        
        .deposit-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 15px;
            border-radius: 15px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            margin-top: 5px;
            display: inline-block;
        }
        
        .deposit-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }
        
        /* DEPOSIT POPUP */
        .deposit-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.98), rgba(30, 0, 0, 0.98));
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            padding: 20px;
            backdrop-filter: blur(20px);
        }
        
        .deposit-popup.active {
            opacity: 1;
            visibility: visible;
        }
        
        .deposit-content {
            background: linear-gradient(135deg, rgba(20, 0, 0, 0.98), rgba(40, 0, 0, 0.98));
            border-radius: 30px;
            padding: 50px;
            width: 90%;
            max-width: 800px;
            box-shadow: 0 30px 80px rgba(255, 0, 0, 0.4);
            border: 3px solid rgba(255, 0, 0, 0.6);
            transform: scale(0.9);
            transition: transform 0.3s ease;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .deposit-popup.active .deposit-content {
            transform: scale(1);
        }
        
        .popup-title {
            font-size: 42px;
            color: #ff0000;
            text-shadow: 0 0 30px rgba(255, 0, 0, 0.7);
            margin-bottom: 15px;
            background: linear-gradient(45deg, #ff0000, #ff6b6b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .popup-subtitle {
            color: #ff6b6b;
            margin-bottom: 40px;
            font-size: 18px;
            opacity: 0.9;
        }
        
        /* DEPOSIT FORM */
        .deposit-form {
            background: linear-gradient(135deg, rgba(255, 0, 0, 0.1), rgba(255, 107, 107, 0.1));
            border-radius: 25px;
            padding: 35px;
            margin: 30px 0;
            border: 2px solid rgba(255, 0, 0, 0.3);
        }
        
        .form-group {
            margin-bottom: 25px;
            text-align: left;
        }
        
        .form-label {
            display: flex;
            align-items: center;
            gap: 12px;
            color: #ff6b6b;
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 12px;
        }
        
        .form-label i {
            color: #ff0000;
            font-size: 20px;
        }
        
        .form-input {
            width: 100%;
            padding: 18px 22px;
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid rgba(255, 0, 0, 0.4);
            border-radius: 18px;
            color: white;
            font-size: 18px;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #ff0000;
            box-shadow: 0 0 30px rgba(255, 0, 0, 0.3);
            background: rgba(0, 0, 0, 0.9);
        }
        
        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.3);
            font-size: 16px;
        }
        
        .optional-badge {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
            padding: 5px 15px;
            border-radius: 30px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 15px;
            border: 1px solid rgba(255, 193, 7, 0.5);
        }
        
        .amount-presets {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .amount-preset {
            background: rgba(255, 0, 0, 0.1);
            border: 2px solid rgba(255, 0, 0, 0.3);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
            font-weight: bold;
            font-size: 18px;
        }
        
        .amount-preset:hover {
            background: rgba(255, 0, 0, 0.2);
            border-color: #ff0000;
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255, 0, 0, 0.3);
        }
        
        .amount-preset.selected {
            background: linear-gradient(135deg, #ff0000, #ff6b6b);
            border-color: white;
            color: black;
        }
        
        .min-deposit-note {
            background: rgba(255, 193, 7, 0.15);
            border: 2px solid rgba(255, 193, 7, 0.4);
            border-radius: 15px;
            padding: 15px 20px;
            margin: 25px 0 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            color: #ffc107;
            font-weight: bold;
        }
        
        .min-deposit-note i {
            font-size: 24px;
        }
        
        .payment-methods-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .payment-method-item {
            background: linear-gradient(135deg, rgba(255, 0, 0, 0.1), rgba(255, 107, 107, 0.1));
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            border: 2px solid rgba(255, 0, 0, 0.3);
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .payment-method-item:hover {
            transform: translateY(-5px);
            border-color: rgba(255, 0, 0, 0.8);
            box-shadow: 0 15px 35px rgba(255, 0, 0, 0.3);
            background: linear-gradient(135deg, rgba(255, 0, 0, 0.2), rgba(255, 107, 107, 0.2));
        }
        
        .payment-method-item.selected {
            background: linear-gradient(135deg, rgba(255, 0, 0, 0.3), rgba(255, 107, 107, 0.3));
            border-color: #ff0000;
            box-shadow: 0 0 30px rgba(255, 0, 0, 0.5);
        }
        
        .payment-method-icon {
            font-size: 36px;
            margin-bottom: 10px;
        }
        
        .payment-method-name {
            font-weight: bold;
            font-size: 18px;
            color: white;
            margin-bottom: 5px;
        }
        
        .payment-method-number {
            font-family: monospace;
            font-size: 14px;
            color: #ff6b6b;
            background: rgba(0, 0, 0, 0.5);
            padding: 8px;
            border-radius: 10px;
            margin-top: 10px;
            word-break: break-all;
        }
        
        .deposit-summary {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.6), rgba(20, 0, 0, 0.6));
            border-radius: 20px;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid rgba(255, 193, 7, 0.3);
        }
        
        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 18px;
        }
        
        .summary-row:last-child {
            border-bottom: none;
        }
        
        .summary-label {
            color: #ffc107;
            font-weight: bold;
        }
        
        .summary-value {
            color: white;
            font-weight: bold;
        }
        
        .popup-buttons {
            display: flex;
            gap: 20px;
            margin-top: 40px;
            justify-content: center;
        }
        
        .popup-btn {
            padding: 20px 40px;
            border-radius: 20px;
            border: none;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 18px;
            min-width: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .popup-btn-primary {
            background: linear-gradient(135deg, #ff0000, #ff6b6b);
            color: #000;
        }
        
        .popup-btn-primary:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(255, 0, 0, 0.4);
        }
        
        .popup-btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }
        
        .popup-btn-secondary {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            color: #fff;
            border: 3px solid rgba(255, 255, 255, 0.2);
        }
        
        .popup-btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-3px);
        }
        
        /* DISCOUNT CODE SECTION */
        .discount-section {
            background: linear-gradient(135deg, rgba(255, 193, 7, 0.1), rgba(255, 215, 0, 0.1));
            border-radius: 25px;
            padding: 25px;
            margin: 30px 0 20px;
            border: 2px solid rgba(255, 193, 7, 0.4);
            position: relative;
            overflow: hidden;
        }
        
        .discount-section::before {
            content: 'ðŸ’¸';
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 100px;
            opacity: 0.1;
            transform: rotate(15deg);
        }
        
        .discount-title {
            color: #ffc107;
            font-size: 24px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            font-weight: bold;
        }
        
        .discount-input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .discount-input {
            flex: 1;
            min-width: 250px;
            padding: 18px 22px;
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid rgba(255, 193, 7, 0.4);
            border-radius: 18px;
            color: white;
            font-size: 18px;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: all 0.3s;
        }
        
        .discount-input:focus {
            outline: none;
            border-color: #ffc107;
            box-shadow: 0 0 30px rgba(255, 193, 7, 0.3);
        }
        
        .discount-apply-btn {
            background: linear-gradient(135deg, #ffc107, #ff9800);
            color: #000;
            border: none;
            padding: 18px 35px;
            border-radius: 18px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 12px;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .discount-apply-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(255, 193, 7, 0.4);
        }
        
        .discount-apply-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .discount-info {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            display: none;
            border: 2px solid rgba(255, 193, 7, 0.3);
        }
        
        .discount-info.active {
            display: block;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .discount-detail {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255, 193, 7, 0.2);
            color: white;
        }
        
        .discount-detail:last-child {
            border-bottom: none;
        }
        
        .discount-label {
            color: #ffc107;
            font-weight: bold;
        }
        
        .discount-value {
            font-weight: bold;
            color: #4caf50;
        }
        
        .discount-value.original {
            color: #ff6b6b;
            text-decoration: line-through;
            opacity: 0.7;
        }
        
        /* PACKAGE NAME INPUT SECTION */
        .package-section {
            background: linear-gradient(135deg, rgba(33, 150, 243, 0.1), rgba(33, 150, 243, 0.1));
            border-radius: 25px;
            padding: 25px;
            margin: 30px 0 20px;
            border: 2px solid rgba(33, 150, 243, 0.4);
            position: relative;
            overflow: hidden;
        }
        
        .package-section::before {
            content: 'ðŸ“¦';
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 100px;
            opacity: 0.1;
            transform: rotate(-15deg);
        }
        
        .package-title {
            color: #2196f3;
            font-size: 24px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            font-weight: bold;
        }
        
        .package-input-group {
            margin-bottom: 15px;
        }
        
        .package-input {
            width: 100%;
            padding: 18px 22px;
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid rgba(33, 150, 243, 0.4);
            border-radius: 18px;
            color: white;
            font-size: 18px;
            font-family: monospace;
            letter-spacing: 1px;
            transition: all 0.3s;
        }
        
        .package-input:focus {
            outline: none;
            border-color: #2196f3;
            box-shadow: 0 0 30px rgba(33, 150, 243, 0.3);
        }
        
        .package-input::placeholder {
            color: rgba(255, 255, 255, 0.3);
            font-size: 16px;
        }
        
        .package-info {
            color: #2196f3;
            font-size: 14px;
            margin-top: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .package-info i {
            font-size: 16px;
        }
        
        /* VIP UPDATE POPUP - KHUSUS UNTUK PEMBELI VIP */
        .vip-update-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.98), rgba(30, 0, 0, 0.98));
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10001;
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s ease;
            padding: 20px;
            backdrop-filter: blur(30px);
        }
        
        .vip-update-popup.active {
            opacity: 1;
            visibility: visible;
        }
        
        .vip-update-content {
            background: linear-gradient(135deg, #1a0000, #2d0000);
            border-radius: 40px;
            padding: 60px;
            width: 90%;
            max-width: 900px;
            box-shadow: 0 0 100px rgba(255, 0, 0, 0.6);
            border: 4px solid rgba(255, 215, 0, 0.8);
            transform: scale(0.8) translateY(50px);
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            position: relative;
            overflow: hidden;
        }
        
        .vip-update-popup.active .vip-update-content {
            transform: scale(1) translateY(0);
        }
        
        .vip-update-content::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 215, 0, 0.1) 0%, transparent 70%);
            animation: rotateVIP 20s linear infinite;
        }
        
        @keyframes rotateVIP {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .vip-update-header {
            display: flex;
            align-items: center;
            gap: 30px;
            margin-bottom: 40px;
            position: relative;
            z-index: 1;
        }
        
        .vip-update-icon {
            font-size: 80px;
            color: #ffd700;
            text-shadow: 0 0 40px rgba(255, 215, 0, 0.6);
            animation: pulseVIP 2s infinite;
        }
        
        @keyframes pulseVIP {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.9; }
        }
        
        .vip-update-title {
            font-size: 48px;
            font-weight: 900;
            background: linear-gradient(45deg, #ffd700, #ffaa00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
            letter-spacing: 3px;
        }
        
        .vip-update-badge {
            background: linear-gradient(135deg, #ff0000, #cc0000);
            color: white;
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 20px;
            font-weight: bold;
            display: inline-block;
            margin-left: 20px;
            border: 2px solid #ffd700;
            box-shadow: 0 0 30px rgba(255, 0, 0, 0.5);
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .vip-update-info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
            margin: 40px 0;
            position: relative;
            z-index: 1;
        }
        
        .vip-update-info-item {
            background: rgba(0, 0, 0, 0.7);
            border-radius: 25px;
            padding: 30px;
            border: 2px solid rgba(255, 215, 0, 0.5);
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }
        
        .vip-update-info-item:hover {
            transform: translateY(-5px);
            border-color: #ffd700;
            box-shadow: 0 15px 40px rgba(255, 215, 0, 0.3);
        }
        
        .vip-update-info-label {
            color: #ffd700;
            font-size: 18px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: bold;
        }
        
        .vip-update-info-label i {
            font-size: 24px;
        }
        
        .vip-update-info-value {
            color: white;
            font-size: 22px;
            font-weight: bold;
            word-break: break-word;
            line-height: 1.5;
            font-family: 'Segoe UI', sans-serif;
        }
        
        .vip-update-description {
            background: rgba(255, 215, 0, 0.1);
            border-radius: 25px;
            padding: 35px;
            margin: 30px 0;
            border: 2px solid rgba(255, 215, 0, 0.5);
            position: relative;
            z-index: 1;
            backdrop-filter: blur(10px);
        }
        
        .vip-update-description-title {
            color: #ffd700;
            font-size: 24px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            font-weight: bold;
        }
        
        .vip-update-description-text {
            color: white;
            font-size: 18px;
            line-height: 1.8;
            word-break: break-word;
        }
        
        .vip-update-link-container {
            background: rgba(0, 0, 0, 0.8);
            border-radius: 20px;
            padding: 25px;
            margin-top: 30px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 20px;
            border: 2px solid #4caf50;
            position: relative;
            z-index: 1;
        }
        
        .vip-update-link {
            color: #4caf50;
            font-size: 18px;
            word-break: break-all;
            font-family: monospace;
            flex: 1;
        }
        
        .vip-update-copy-btn {
            background: linear-gradient(135deg, #4caf50, #2e7d32);
            color: white;
            border: none;
            padding: 15px 35px;
            border-radius: 15px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 12px;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .vip-update-copy-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(76, 175, 80, 0.5);
        }
        
        .vip-update-footer {
            display: flex;
            justify-content: flex-end;
            margin-top: 40px;
            position: relative;
            z-index: 1;
        }
        
        .vip-update-close-btn {
            background: linear-gradient(135deg, #ff3333, #cc0000);
            color: white;
            border: none;
            padding: 18px 45px;
            border-radius: 15px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            border: 2px solid #ffd700;
        }
        
        .vip-update-close-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(255, 0, 0, 0.6);
        }
        
        /* ==================== MAINTENANCE PAGE - FIXED & ENHANCED ==================== */
        .maintenance-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.98), rgba(30, 0, 0, 0.98));
            z-index: 100000;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(20px);
        }
        
        .maintenance-page.active {
            display: flex;
        }
        
        .maintenance-page-content {
            max-width: 900px;
            width: 90%;
            text-align: center;
            background: linear-gradient(135deg, rgba(20, 0, 0, 0.98), rgba(40, 0, 0, 0.98));
            border-radius: 40px;
            padding: 60px 40px;
            border: 3px solid rgba(255, 0, 0, 0.6);
            box-shadow: 0 30px 80px rgba(255, 0, 0, 0.4);
            position: relative;
            overflow: hidden;
            animation: fadeInMaintenance 0.8s ease;
        }
        
        @keyframes fadeInMaintenance {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .maintenance-page-content::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,0,0,0.1) 0%, transparent 70%);
            animation: rotateMaintenance 25s linear infinite;
            z-index: -1;
        }
        
        @keyframes rotateMaintenance {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
        
        .maintenance-page-icon {
            font-size: 90px;
            color: #ff0000;
            margin-bottom: 30px;
            animation: pulseMaintenanceIcon 2.5s infinite;
            text-shadow: 0 0 30px rgba(255, 0, 0, 0.7);
        }
        
        @keyframes pulseMaintenanceIcon {
            0%, 100% {
                transform: scale(1);
                text-shadow: 0 0 20px rgba(255, 0, 0, 0.6);
            }
            50% {
                transform: scale(1.1);
                text-shadow: 0 0 50px rgba(255, 0, 0, 0.9);
            }
        }
        
        .maintenance-page-title {
            font-size: 52px;
            font-weight: 900;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #ff0000, #ff6b6b, #ff3333);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px rgba(255, 0, 0, 0.5);
            letter-spacing: 3px;
        }
        
        .maintenance-page-message {
            font-size: 20px;
            color: #fff;
            margin-bottom: 30px;
            line-height: 1.7;
            padding: 0 20px;
            opacity: 0.95;
        }
        
        .maintenance-page-timer-container {
            background: linear-gradient(135deg, rgba(255, 0, 0, 0.15), rgba(255, 107, 107, 0.15));
            border-radius: 30px;
            padding: 35px 30px;
            margin: 30px 0;
            border: 2px solid rgba(255, 0, 0, 0.5);
            backdrop-filter: blur(10px);
        }
        
        .maintenance-page-timer-title {
            color: #ffd700;
            font-size: 20px;
            margin-bottom: 20px;
            font-weight: bold;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        
        .maintenance-page-timer {
            font-size: 70px;
            font-weight: 900;
            color: #ff0000;
            font-family: 'Courier New', monospace;
            letter-spacing: 5px;
            margin: 20px 0;
            text-shadow: 0 0 30px rgba(255, 0, 0, 0.8);
            background: rgba(0, 0, 0, 0.8);
            padding: 25px 20px;
            border-radius: 20px;
            border: 3px solid #ff0000;
            box-shadow: 0 0 40px rgba(255, 0, 0, 0.3);
        }
        
        .maintenance-page-progress {
            width: 100%;
            height: 15px;
            background: rgba(255, 0, 0, 0.2);
            border-radius: 10px;
            margin: 30px 0 15px;
            overflow: hidden;
            border: 1px solid rgba(255, 0, 0, 0.5);
        }
        
        .maintenance-page-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #ff0000, #ff6b6b, #ff3333);
            width: 0%;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .maintenance-page-progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: progressShine 2s infinite;
        }
        
        @keyframes progressShine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .maintenance-page-info {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 40px 0 30px;
        }
        
        @media (max-width: 768px) {
            .maintenance-page-info {
                grid-template-columns: 1fr;
            }
        }
        
        .maintenance-page-info-item {
            background: rgba(255, 0, 0, 0.1);
            border-radius: 20px;
            padding: 25px 20px;
            border: 2px solid rgba(255, 0, 0, 0.3);
            transition: all 0.3s;
            backdrop-filter: blur(5px);
        }
        
        .maintenance-page-info-item:hover {
            transform: translateY(-5px);
            border-color: rgba(255, 0, 0, 0.8);
            box-shadow: 0 15px 35px rgba(255, 0, 0, 0.3);
            background: rgba(255, 0, 0, 0.15);
        }
        
        .maintenance-page-info-label {
            color: #ffd700;
            font-size: 15px;
            margin-bottom: 12px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1.5px;
        }
        
        .maintenance-page-info-value {
            color: #fff;
            font-size: 20px;
            font-weight: 600;
            word-break: break-word;
        }
        
        .maintenance-page-additional {
            margin: 30px 0 20px;
            padding: 25px;
            background: rgba(255, 193, 7, 0.1);
            border-radius: 20px;
            border: 2px solid rgba(255, 193, 7, 0.3);
            color: #ffc107;
            font-size: 18px;
            line-height: 1.6;
        }
        
        .maintenance-page-refresh-btn {
            background: linear-gradient(135deg, #ff0000, #cc0000);
            color: white;
            border: none;
            padding: 22px 45px;
            border-radius: 20px;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.4s;
            margin-top: 40px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 10px 30px rgba(255, 0, 0, 0.4);
            position: relative;
            overflow: hidden;
        }
        
        .maintenance-page-refresh-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .maintenance-page-refresh-btn:hover::before {
            width: 300px;
            height: 300px;
        }
        
        .maintenance-page-refresh-btn:hover {
            transform: translateY(-8px);
            box-shadow: 0 25px 50px rgba(255, 0, 0, 0.6);
            border-color: rgba(255, 255, 255, 0.6);
        }
        
        .maintenance-page-refresh-btn i {
            font-size: 22px;
            animation: spinButtonIcon 2s infinite linear;
        }
        
        @keyframes spinButtonIcon {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        /* ==================== VIP GLOBAL UPDATE POPUP - NEW & ENHANCED ==================== */
        .vip-global-update-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.98), rgba(50, 0, 0, 0.98));
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100001;
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            padding: 20px;
            backdrop-filter: blur(30px);
        }
        
        .vip-global-update-popup.active {
            opacity: 1;
            visibility: visible;
        }
        
        .vip-global-update-content {
            background: linear-gradient(145deg, #1a0a0a, #2a0a0a);
            border-radius: 60px 60px 60px 60px;
            padding: 60px 50px;
            width: 95%;
            max-width: 1000px;
            box-shadow: 0 0 150px rgba(255, 215, 0, 0.5);
            border: 3px solid rgba(255, 215, 0, 0.9);
            transform: scale(0.6) rotate(-10deg);
            transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            overflow: hidden;
            background-image: radial-gradient(circle at 20% 30%, rgba(255,215,0,0.15) 0%, transparent 50%),
                              radial-gradient(circle at 80% 70%, rgba(255,0,0,0.15) 0%, transparent 50%);
        }
        
        .vip-global-update-popup.active .vip-global-update-content {
            transform: scale(1) rotate(0deg);
        }
        
        .vip-global-update-content::before {
            content: 'â˜…';
            position: absolute;
            top: -30px;
            left: -30px;
            font-size: 200px;
            color: rgba(255, 215, 0, 0.1);
            transform: rotate(15deg);
            pointer-events: none;
        }
        
        .vip-global-update-content::after {
            content: 'VIP';
            position: absolute;
            bottom: -30px;
            right: -30px;
            font-size: 180px;
            font-weight: 900;
            color: rgba(255, 0, 0, 0.08);
            transform: rotate(-10deg);
            pointer-events: none;
            letter-spacing: 20px;
        }
        
        .vip-global-update-header {
            display: flex;
            align-items: center;
            gap: 40px;
            margin-bottom: 50px;
            position: relative;
            z-index: 2;
            flex-wrap: wrap;
        }
        
        .vip-global-update-icon {
            font-size: 110px;
            color: #ffd700;
            text-shadow: 0 0 50px rgba(255, 215, 0, 0.8), 0 0 100px rgba(255, 0, 0, 0.5);
            animation: vipCrownPulse 2.5s infinite;
            background: radial-gradient(circle, rgba(255,215,0,0.3) 0%, transparent 70%);
            padding: 25px;
            border-radius: 50%;
        }
        
        @keyframes vipCrownPulse {
            0%, 100% { 
                transform: scale(1) rotate(0deg);
                filter: drop-shadow(0 0 30px #ffd700);
            }
            50% { 
                transform: scale(1.15) rotate(5deg);
                filter: drop-shadow(0 0 60px #ffaa00);
            }
        }
        
        .vip-global-update-title-section {
            flex: 1;
        }
        
        .vip-global-update-title {
            font-size: 58px;
            font-weight: 900;
            background: linear-gradient(45deg, #ffd700, #ffaa00, #ff8800);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 40px rgba(255, 215, 0, 0.5);
            letter-spacing: 4px;
            margin-bottom: 15px;
        }
        
        .vip-global-update-badge {
            background: linear-gradient(135deg, #ff0000, #b30000);
            color: #ffd700;
            padding: 12px 35px;
            border-radius: 50px;
            font-size: 20px;
            font-weight: bold;
            display: inline-block;
            border: 2px solid #ffd700;
            box-shadow: 0 0 40px rgba(255, 0, 0, 0.7);
            text-transform: uppercase;
            letter-spacing: 3px;
            animation: badgePulse 2s infinite;
        }
        
        @keyframes badgePulse {
            0%, 100% { box-shadow: 0 0 30px rgba(255, 0, 0, 0.7); }
            50% { box-shadow: 0 0 60px rgba(255, 215, 0, 0.7); }
        }
        
        .vip-global-update-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 35px;
            margin: 50px 0;
            position: relative;
            z-index: 2;
        }
        
        @media (max-width: 768px) {
            .vip-global-update-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .vip-global-update-item {
            background: rgba(0, 0, 0, 0.7);
            border-radius: 30px;
            padding: 35px;
            border: 2px solid rgba(255, 215, 0, 0.6);
            backdrop-filter: blur(15px);
            transition: all 0.4s;
            position: relative;
            overflow: hidden;
        }
        
        .vip-global-update-item:hover {
            transform: translateY(-10px) scale(1.02);
            border-color: #ffd700;
            box-shadow: 0 20px 50px rgba(255, 215, 0, 0.4);
            background: rgba(20, 0, 0, 0.8);
        }
        
        .vip-global-update-item::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,215,0,0.1) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.4s;
        }
        
        .vip-global-update-item:hover::after {
            opacity: 1;
        }
        
        .vip-global-update-item-label {
            color: #ffd700;
            font-size: 20px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .vip-global-update-item-label i {
            font-size: 28px;
            color: #ffd700;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }
        
        .vip-global-update-item-value {
            color: white;
            font-size: 24px;
            font-weight: bold;
            word-break: break-word;
            line-height: 1.5;
            font-family: 'Courier New', monospace;
            background: rgba(255, 255, 255, 0.05);
            padding: 15px 20px;
            border-radius: 15px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }
        
        .vip-global-update-description {
            background: rgba(255, 215, 0, 0.1);
            border-radius: 35px;
            padding: 45px;
            margin: 40px 0;
            border: 2px solid rgba(255, 215, 0, 0.7);
            position: relative;
            z-index: 2;
            backdrop-filter: blur(15px);
            box-shadow: inset 0 0 50px rgba(255, 215, 0, 0.1);
        }
        
        .vip-global-update-description-title {
            color: #ffd700;
            font-size: 28px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 20px;
            font-weight: bold;
            border-bottom: 2px solid rgba(255, 215, 0, 0.5);
            padding-bottom: 20px;
        }
        
        .vip-global-update-description-text {
            color: white;
            font-size: 20px;
            line-height: 1.8;
            word-break: break-word;
            font-weight: 400;
        }
        
        .vip-global-update-link-container {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.9), rgba(30, 0, 0, 0.9));
            border-radius: 30px;
            padding: 30px 35px;
            margin: 40px 0 30px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 25px;
            border: 3px solid #4caf50;
            position: relative;
            z-index: 2;
            box-shadow: 0 10px 40px rgba(76, 175, 80, 0.3);
        }
        
        .vip-global-update-link {
            color: #4caf50;
            font-size: 20px;
            word-break: break-all;
            font-family: 'Courier New', monospace;
            flex: 1;
            font-weight: bold;
            text-shadow: 0 0 15px rgba(76, 175, 80, 0.5);
        }
        
        .vip-global-update-copy-btn {
            background: linear-gradient(135deg, #4caf50, #2e7d32);
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.4s;
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            border: 2px solid rgba(255, 255, 255, 0.4);
            box-shadow: 0 5px 20px rgba(76, 175, 80, 0.5);
            position: relative;
            overflow: hidden;
        }
        
        .vip-global-update-copy-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 20px 40px rgba(76, 175, 80, 0.7);
            border-color: rgba(255, 255, 255, 0.8);
        }
        
        .vip-global-update-copy-btn:active {
            transform: translateY(0) scale(0.98);
        }
        
        .vip-global-update-footer {
            display: flex;
            justify-content: flex-end;
            margin-top: 50px;
            position: relative;
            z-index: 2;
        }
        
        .vip-global-update-close-btn {
            background: linear-gradient(135deg, #ff3333, #b30000);
            color: white;
            border: none;
            padding: 22px 55px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.4s;
            font-size: 22px;
            display: flex;
            align-items: center;
            gap: 18px;
            border: 2px solid #ffd700;
            box-shadow: 0 10px 30px rgba(255, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
            letter-spacing: 2px;
        }
        
        .vip-global-update-close-btn:hover {
            transform: translateY(-7px);
            box-shadow: 0 25px 55px rgba(255, 0, 0, 0.8);
            border-color: #fff;
            background: linear-gradient(135deg, #ff5555, #cc0000);
        }
        
        .vip-global-update-close-btn i {
            font-size: 24px;
            animation: checkPulse 2s infinite;
        }
        
        @keyframes checkPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        
        /* UPDATE COUNTER DISPLAY */
        .update-counter {
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(56, 142, 60, 0.05));
            border-radius: 20px;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid rgba(76, 175, 80, 0.3);
            text-align: center;
            position: relative;
            overflow: hidden;
            display: none;
        }
        
        .update-counter::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent, rgba(76, 175, 80, 0.05), transparent);
            animation: slideBackground 10s infinite linear;
        }
        
        .counter-title {
            color: #4caf50;
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .counter-display {
            font-size: 48px;
            font-weight: bold;
            color: #4caf50;
            margin: 20px 0;
            font-family: monospace;
            text-shadow: 0 0 20px rgba(76, 175, 80, 0.5);
        }
        
        .counter-progress {
            height: 15px;
            background: rgba(76, 175, 80, 0.2);
            border-radius: 10px;
            overflow: hidden;
            margin: 25px 0;
            border: 1px solid rgba(76, 175, 80, 0.3);
        }
        
        .counter-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4caf50, #2e7d32);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .counter-progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shineProgress 2s infinite;
        }
        
        @keyframes shineProgress {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .counter-info {
            color: #ff6b6b;
            font-size: 16px;
            font-style: italic;
            margin-top: 15px;
        }
        
        /* PURCHASE HISTORY */
        .purchase-history {
            background: linear-gradient(135deg, rgba(33, 150, 243, 0.1), rgba(33, 150, 243, 0.05));
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            border: 2px solid rgba(33, 150, 243, 0.3);
            display: none;
        }
        
        .history-title {
            color: #2196f3;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(33, 150, 243, 0.3);
        }
        
        .history-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .history-item {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 20px;
            border-left: 5px solid #2196f3;
            transition: all 0.3s;
        }
        
        .history-item:hover {
            background: rgba(0, 0, 0, 0.6);
            transform: translateX(10px);
        }
        
        .history-package {
            font-weight: bold;
            color: #2196f3;
            margin-bottom: 10px;
            font-size: 18px;
        }
        
        .history-details {
            display: flex;
            justify-content: space-between;
            color: #ff6b6b;
            font-size: 15px;
        }
        
        /* LANGUAGE SWITCHER */
        .language-switcher {
            position: fixed;
            top: 20px;
            right: 250px;
            z-index: 9990;
        }
        
        .lang-btn {
            background-color: rgba(255, 0, 0, 0.8);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.5);
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }
        
        .lang-btn:hover {
            background-color: rgba(255, 0, 0, 1);
            transform: scale(1.05);
        }
        
        .lang-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 10px;
            background-color: rgba(0, 0, 0, 0.95);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 2px solid rgba(255, 0, 0, 0.5);
            display: none;
            backdrop-filter: blur(10px);
            z-index: 10000;
        }
        
        .lang-dropdown.show {
            display: block;
            animation: slideDown 0.3s ease;
        }
        
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .lang-option {
            padding: 15px 25px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s;
            white-space: nowrap;
            border-bottom: 1px solid rgba(255, 0, 0, 0.2);
        }
        
        .lang-option:hover {
            background-color: rgba(255, 0, 0, 0.2);
        }
        
        .lang-flag {
            width: 25px;
            height: 18px;
            border-radius: 3px;
            object-fit: cover;
        }
        
        .lang-text {
            font-size: 14px;
            font-weight: bold;
        }
        
        /* ADMIN ONLINE STATUS */
        .admin-status {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 9990;
            display: none;
            align-items: center;
            gap: 10px;
            background-color: rgba(0, 0, 0, 0.8);
            padding: 12px 20px;
            border-radius: 25px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
        }
        
        .status-indicator {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            position: relative;
        }
        
        .status-online {
            background-color: #4caf50;
            box-shadow: 0 0 15px rgba(76, 175, 80, 0.8);
            animation: pulseOnline 2s infinite;
        }
        
        @keyframes pulseOnline {
            0% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(76, 175, 80, 0); }
            100% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0); }
        }
        
        .status-offline {
            background-color: #f44336;
            box-shadow: 0 0 15px rgba(244, 67, 54, 0.8);
        }
        
        .status-text {
            font-size: 15px;
            font-weight: bold;
        }
        
        /* MAIN CONTAINER */
        .container {
            position: relative;
            z-index: 1;
            width: 100%;
            min-height: 100vh;
            display: none;
            flex-direction: column;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-top: 100px;
        }
        
        .title {
            font-size: 48px;
            background: linear-gradient(45deg, #ff0000, #ff6b6b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
            text-shadow: 0 0 30px rgba(255, 0, 0, 0.5);
        }
        
        .subtitle {
            font-size: 20px;
            color: #ff6b6b;
            opacity: 0.9;
        }
        
        .content-container {
            background: linear-gradient(135deg, rgba(20, 0, 0, 0.8), rgba(40, 0, 0, 0.8));
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 20px 50px rgba(255, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 0, 0, 0.3);
            margin-bottom: 40px;
        }
        
        h1 {
            color: #ff0000;
            text-align: center;
            border-bottom: 3px solid rgba(255, 0, 0, 0.5);
            padding-bottom: 20px;
            margin-bottom: 30px;
            font-size: 36px;
            text-shadow: 0 0 20px rgba(255, 0, 0, 0.5);
        }
        
        /* UID DISPLAY */
        .uid-container {
            background: linear-gradient(135deg, rgba(255, 0, 0, 0.1), rgba(255, 107, 107, 0.1));
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 40px;
            border: 2px solid rgba(255, 0, 0, 0.3);
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .uid-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent, rgba(255,0,0,0.05), transparent);
            animation: slideBackground 10s infinite linear;
        }
        
        @keyframes slideBackground {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .uid-title {
            color: #ff0000;
            font-weight: bold;
            margin-bottom: 20px;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .uid-value {
            font-family: monospace;
            font-size: 32px;
            letter-spacing: 2px;
            background: rgba(0, 0, 0, 0.9);
            padding: 30px;
            border-radius: 15px;
            margin: 25px 0;
            cursor: pointer;
            user-select: all;
            border: 2px solid #ff0000;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .uid-value:hover {
            background: rgba(20, 0, 0, 0.95);
            transform: scale(1.02);
            box-shadow: 0 15px 35px rgba(255, 0, 0, 0.3);
        }
        
        .uid-info {
            color: #ff6b6b;
            font-size: 18px;
            margin-bottom: 25px;
        }
        
        .uid-buttons {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .uid-copy-btn, .change-uid-btn {
            padding: 18px 35px;
            border-radius: 15px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            font-size: 18px;
            min-width: 200px;
        }
        
        .uid-copy-btn {
            background: linear-gradient(135deg, #4caf50, #2e7d32);
            color: white;
        }
        
        .uid-copy-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(76, 175, 80, 0.3);
        }
        
        .change-uid-btn {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            color: #000;
        }
        
        .change-uid-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(255, 152, 0, 0.3);
        }
        
        /* VIP FEATURES GRID */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }
        
        .feature-card {
            background: linear-gradient(135deg, rgba(255, 0, 0, 0.1), rgba(255, 107, 107, 0.1));
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            border: 2px solid rgba(255, 0, 0, 0.3);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(255, 0, 0, 0.2);
            border-color: rgba(255, 0, 0, 0.5);
        }
        
        .feature-icon {
            font-size: 48px;
            color: #ff0000;
            margin-bottom: 20px;
        }
        
        .feature-name {
            color: #ff6b6b;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .feature-desc {
            color: #fff;
            font-size: 16px;
            opacity: 0.9;
        }
        
        /* PRICE OPTIONS */
        .price-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 50px 0;
        }
        
        .price-card {
            background: linear-gradient(135deg, rgba(255, 0, 0, 0.1), rgba(255, 107, 107, 0.1));
            border-radius: 25px;
            padding: 35px;
            text-align: center;
            border: 3px solid rgba(255, 0, 0, 0.3);
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .price-card.selected {
            background: linear-gradient(135deg, rgba(255, 0, 0, 0.3), rgba(255, 107, 107, 0.3));
            border-color: #ff0000;
            box-shadow: 0 25px 50px rgba(255, 0, 0, 0.3);
            transform: translateY(-10px);
        }
        
        .price-card:hover {
            transform: translateY(-8px);
            border-color: rgba(255, 0, 0, 0.5);
            box-shadow: 0 20px 40px rgba(255, 0, 0, 0.2);
        }
        
        .price-icon {
            font-size: 56px;
            color: #ff0000;
            margin-bottom: 25px;
        }
        
        .price-amount {
            font-size: 36px;
            font-weight: bold;
            color: #ff0000;
            margin-bottom: 15px;
            text-shadow: 0 0 20px rgba(255, 0, 0, 0.3);
        }
        
        .price-duration {
            color: #ff6b6b;
            font-size: 20px;
            margin-bottom: 20px;
            font-weight: bold;
        }
        
        .price-updates {
            color: #2196f3;
            font-size: 18px;
            font-weight: bold;
            margin: 15px 0;
            padding: 12px;
            background: rgba(33, 150, 243, 0.15);
            border-radius: 15px;
            border: 2px solid rgba(33, 150, 243, 0.3);
        }
        
        .price-features {
            color: #fff;
            font-size: 16px;
            opacity: 0.9;
            line-height: 1.6;
        }
        
        /* ORDER SUMMARY */
        .order-summary {
            background: linear-gradient(135deg, rgba(255, 193, 7, 0.1), rgba(255, 235, 59, 0.1));
            border-radius: 20px;
            padding: 35px;
            margin: 50px 0;
            border: 2px solid rgba(255, 193, 7, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .summary-title {
            color: #ffc107;
            text-align: center;
            margin-bottom: 30px;
            font-size: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
        }
        
        .summary-item {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid rgba(255, 193, 7, 0.2);
        }
        
        .summary-label {
            color: #ffc107;
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .summary-value {
            font-weight: bold;
            color: #fff;
            font-size: 22px;
            word-break: break-word;
        }
        
        /* ACTION BUTTONS */
        .action-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin: 50px 0;
        }
        
        .action-btn {
            padding: 25px;
            border-radius: 20px;
            border: none;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #ff0000, #ff6b6b);
            color: #000;
        }
        
        .submit-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 50px rgba(255, 0, 0, 0.3);
        }
        
        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }
        
        .reset-btn {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            color: #fff;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .reset-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-5px);
        }
        
        /* ==================== CHAT CONTAINER - ENHANCED ==================== */
        .chat-container {
            background: linear-gradient(135deg, rgba(20, 0, 0, 0.9), rgba(40, 0, 0, 0.9));
            border-radius: 25px;
            padding: 40px;
            margin-top: 50px;
            border: 2px solid rgba(255, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            height: 700px;
            position: relative;
            overflow: hidden;
        }
        
        .chat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(255, 0, 0, 0.3);
        }
        
        .chat-title {
            color: #ff0000;
            font-size: 28px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .chat-status {
            font-size: 16px;
            color: #4caf50;
            background: rgba(76, 175, 80, 0.1);
            padding: 12px 25px;
            border-radius: 25px;
            border: 2px solid rgba(76, 175, 80, 0.3);
        }
        
        .chat-messages {
            flex: 1;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            overflow-y: auto;
            border: 2px solid rgba(255, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            gap: 20px;
            scroll-behavior: smooth;
        }
        
        .message {
            padding: 20px 30px;
            border-radius: 25px;
            max-width: 80%;
            position: relative;
            word-wrap: break-word;
            animation: messageSlide 0.3s ease;
        }
        
        @keyframes messageSlide {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .customer-message {
            background: linear-gradient(135deg, rgba(255, 0, 0, 0.2), rgba(255, 107, 107, 0.2));
            align-self: flex-end;
            border-bottom-right-radius: 5px;
        }
        
        .admin-message {
            background: linear-gradient(135deg, rgba(24, 255, 255, 0.2), rgba(24, 255, 255, 0.1));
            align-self: flex-start;
            border-bottom-left-radius: 5px;
        }
        
        .system-message {
            background: linear-gradient(135deg, rgba(255, 193, 7, 0.2), rgba(255, 235, 59, 0.1));
            align-self: center;
            text-align: center;
            font-style: italic;
            max-width: 90%;
        }
        
        .message-sender {
            font-size: 14px;
            color: #ff6b6b;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .admin-message .message-sender {
            color: #18ffff;
        }
        
        .message-text {
            word-wrap: break-word;
            line-height: 1.6;
            font-size: 16px;
            white-space: pre-wrap;
        }
        
        .message-time {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
            text-align: right;
            margin-top: 10px;
        }
        
        .chat-input-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .chat-input-row {
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        .chat-input {
            flex: 1;
            padding: 22px;
            border-radius: 20px;
            border: 2px solid rgba(255, 0, 0, 0.5);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            font-size: 18px;
            transition: all 0.3s;
        }
        
        .chat-input:focus {
            outline: none;
            border-color: #ff0000;
            box-shadow: 0 0 30px rgba(255, 0, 0, 0.4);
        }
        
        .chat-attachment-btn {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            color: white;
            border: none;
            width: 70px;
            height: 70px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .chat-attachment-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 30px rgba(255, 152, 0, 0.4);
        }
        
        .chat-send-btn {
            background: linear-gradient(135deg, #4caf50, #2e7d32);
            color: white;
            border: none;
            width: 150px;
            height: 70px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 20px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .chat-send-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 30px rgba(76, 175, 80, 0.3);
        }
        
        .chat-send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }
        
        /* ==================== FILE & IMAGE MESSAGES - ENHANCED ==================== */
        .file-message {
            background: rgba(33, 150, 243, 0.15);
            border: 2px solid rgba(33, 150, 243, 0.4);
            border-radius: 15px;
            padding: 20px;
            margin-top: 15px;
            transition: all 0.3s;
        }
        
        .file-message:hover {
            background: rgba(33, 150, 243, 0.2);
            border-color: rgba(33, 150, 243, 0.8);
        }
        
        .file-info {
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .file-icon {
            font-size: 48px;
            color: #2196f3;
            filter: drop-shadow(0 0 10px rgba(33, 150, 243, 0.5));
        }
        
        .file-details {
            flex: 1;
            min-width: 200px;
        }
        
        .file-name {
            color: #2196f3;
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 8px;
            word-break: break-all;
        }
        
        .file-size {
            color: #9e9e9e;
            font-size: 15px;
        }
        
        .file-download-btn {
            background: linear-gradient(135deg, #2196f3, #1976d2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 16px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .file-download-btn:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 15px 30px rgba(33, 150, 243, 0.5);
        }
        
        .image-message {
            max-width: 100%;
            max-height: 400px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            border: 3px solid rgba(33, 150, 243, 0.3);
            object-fit: contain;
        }
        
        .image-message:hover {
            transform: scale(1.02);
            box-shadow: 0 20px 40px rgba(33, 150, 243, 0.4);
            border-color: #2196f3;
        }
        
        .upload-progress {
            height: 8px;
            background: rgba(76, 175, 80, 0.2);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
            border: 1px solid rgba(76, 175, 80, 0.3);
        }
        
        .upload-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4caf50, #2e7d32);
            width: 0%;
            transition: width 0.2s ease;
            position: relative;
            overflow: hidden;
        }
        
        .upload-progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: progressShine 1.5s infinite;
        }
        
        /* ==================== FILE GALLERY - NEW ==================== */
        .file-gallery {
            background: linear-gradient(135deg, rgba(156, 39, 176, 0.1), rgba(123, 31, 162, 0.1));
            border-radius: 25px;
            padding: 35px;
            margin: 50px 0;
            border: 2px solid rgba(156, 39, 176, 0.3);
            display: none;
        }
        
        .file-gallery.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .gallery-title {
            color: #9c27b0;
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-bottom: 2px solid rgba(156, 39, 176, 0.3);
            padding-bottom: 20px;
        }
        
        .gallery-tabs {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .gallery-tab {
            background: rgba(156, 39, 176, 0.1);
            border: 2px solid rgba(156, 39, 176, 0.3);
            color: white;
            padding: 15px 30px;
            border-radius: 15px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 18px;
        }
        
        .gallery-tab:hover {
            background: rgba(156, 39, 176, 0.2);
            border-color: #9c27b0;
            transform: translateY(-3px);
        }
        
        .gallery-tab.active {
            background: linear-gradient(135deg, #9c27b0, #6a1b9a);
            border-color: white;
            color: white;
        }
        
        .gallery-content {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
            max-height: 600px;
            overflow-y: auto;
            padding: 10px;
        }
        
        .gallery-item {
            background: rgba(0, 0, 0, 0.6);
            border-radius: 20px;
            padding: 20px;
            border: 2px solid rgba(156, 39, 176, 0.3);
            transition: all 0.3s;
            position: relative;
        }
        
        .gallery-item:hover {
            transform: translateY(-5px);
            border-color: #9c27b0;
            box-shadow: 0 15px 35px rgba(156, 39, 176, 0.3);
        }
        
        .gallery-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 15px;
            cursor: pointer;
            margin-bottom: 15px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s;
        }
        
        .gallery-image:hover {
            transform: scale(1.03);
            border-color: #9c27b0;
        }
        
        .gallery-file {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(156, 39, 176, 0.1);
            border-radius: 15px;
        }
        
        .gallery-file-icon {
            font-size: 36px;
            color: #9c27b0;
        }
        
        .gallery-file-info {
            flex: 1;
            min-width: 0;
        }
        
        .gallery-file-name {
            color: #9c27b0;
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 5px;
            word-break: break-all;
        }
        
        .gallery-file-size {
            color: #9e9e9e;
            font-size: 14px;
        }
        
        .gallery-file-date {
            color: rgba(255, 255, 255, 0.5);
            font-size: 12px;
            margin-top: 5px;
        }
        
        .gallery-download-btn {
            background: linear-gradient(135deg, #9c27b0, #6a1b9a);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            margin-top: 10px;
            width: 100%;
            justify-content: center;
        }
        
        .gallery-download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(156, 39, 176, 0.4);
        }
        
        /* ==================== TRANSACTION GALLERY - NEW ==================== */
        .transaction-gallery {
            background: linear-gradient(135deg, rgba(255, 152, 0, 0.1), rgba(255, 87, 34, 0.1));
            border-radius: 25px;
            padding: 35px;
            margin: 50px 0;
            border: 2px solid rgba(255, 152, 0, 0.3);
            display: none;
        }
        
        .transaction-gallery.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .transaction-title {
            color: #ff9800;
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-bottom: 2px solid rgba(255, 152, 0, 0.3);
            padding-bottom: 20px;
        }
        
        .transaction-content {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            max-height: 600px;
            overflow-y: auto;
            padding: 10px;
        }
        
        .transaction-item {
            background: rgba(0, 0, 0, 0.6);
            border-radius: 20px;
            padding: 20px;
            border: 2px solid rgba(255, 152, 0, 0.3);
            transition: all 0.3s;
        }
        
        .transaction-item:hover {
            transform: translateY(-5px);
            border-color: #ff9800;
            box-shadow: 0 15px 35px rgba(255, 152, 0, 0.3);
        }
        
        .transaction-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 152, 0, 0.3);
        }
        
        .transaction-icon {
            font-size: 32px;
            color: #ff9800;
        }
        
        .transaction-info {
            flex: 1;
        }
        
        .transaction-id {
            color: #ff9800;
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 5px;
        }
        
        .transaction-date {
            color: rgba(255, 255, 255, 0.5);
            font-size: 12px;
        }
        
        .transaction-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 15px;
            cursor: pointer;
            margin: 15px 0;
            border: 2px solid rgba(255, 152, 0, 0.3);
            transition: all 0.3s;
        }
        
        .transaction-image:hover {
            transform: scale(1.02);
            border-color: #ff9800;
        }
        
        .transaction-details {
            margin-top: 15px;
            font-size: 14px;
            color: white;
            line-height: 1.6;
        }
        
        .transaction-status {
            display: inline-block;
            padding: 8px 15px;
            border-radius: 10px;
            font-weight: bold;
            font-size: 12px;
            margin-top: 10px;
        }
        
        .status-pending {
            background: rgba(255, 152, 0, 0.2);
            color: #ff9800;
            border: 1px solid #ff9800;
        }
        
        .status-success {
            background: rgba(76, 175, 80, 0.2);
            color: #4caf50;
            border: 1px solid #4caf50;
        }
        
        .status-failed {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
            border: 1px solid #f44336;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* TOAST */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(30, 0, 0, 0.95));
            color: white;
            padding: 20px 35px;
            border-radius: 20px;
            z-index: 1000000;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            border: 2px solid rgba(255, 0, 0, 0.5);
            opacity: 0;
            transition: all 0.3s ease;
            max-width: 90%;
            text-align: center;
            font-weight: bold;
            font-size: 18px;
            backdrop-filter: blur(10px);
        }
        
        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }
        
        /* POPUP UID */
        .uid-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(30, 0, 0, 0.95));
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            padding: 20px;
            backdrop-filter: blur(10px);
        }
        
        .uid-popup.active {
            opacity: 1;
            visibility: visible;
        }
        
        .uid-popup-content {
            background: linear-gradient(135deg, rgba(20, 0, 0, 0.95), rgba(40, 0, 0, 0.95));
            border-radius: 30px;
            padding: 50px;
            width: 90%;
            max-width: 800px;
            box-shadow: 0 30px 60px rgba(255, 0, 0, 0.3);
            border: 3px solid rgba(255, 0, 0, 0.5);
            transform: scale(0.9);
            transition: transform 0.3s ease;
            text-align: center;
        }
        
        .uid-popup.active .uid-popup-content {
            transform: scale(1);
        }
        
        .uid-input-section {
            display: block;
            animation: fadeInUp 0.5s ease;
        }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .input-group {
            margin-bottom: 30px;
            text-align: left;
        }
        
        .input-label {
            display: block;
            margin-bottom: 15px;
            color: #ff6b6b;
            font-weight: bold;
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .uid-input {
            width: 100%;
            padding: 25px;
            background: rgba(0, 0, 0, 0.8);
            border: 3px solid rgba(255, 0, 0, 0.5);
            border-radius: 20px;
            color: white;
            font-size: 22px;
            font-family: monospace;
            letter-spacing: 2px;
            transition: all 0.3s;
        }
        
        .uid-input:focus {
            outline: none;
            border-color: #ff0000;
            box-shadow: 0 0 35px rgba(255, 0, 0, 0.4);
        }
        
        .error-message {
            background: linear-gradient(135deg, rgba(244, 67, 54, 0.1), rgba(229, 57, 53, 0.1));
            border: 2px solid rgba(244, 67, 54, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 25px 0;
            text-align: center;
            color: #f44336;
            display: none;
            font-weight: bold;
            font-size: 18px;
        }
        
        .success-message {
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(56, 142, 60, 0.1));
            border: 2px solid rgba(76, 175, 80, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 25px 0;
            text-align: center;
            color: #4caf50;
            display: none;
            font-weight: bold;
            font-size: 18px;
        }
        
        /* FOOTER */
        .footer {
            text-align: center;
            margin-top: 60px;
            padding: 30px;
            font-size: 18px;
            color: #ff6b6b;
            opacity: 0.7;
            border-top: 2px solid rgba(255, 0, 0, 0.2);
        }
        
        .no-data {
            text-align: center;
            color: #ff6b6b;
            padding: 50px;
            font-style: italic;
            font-size: 20px;
        }
        
        /* RESPONSIVE */
        @media (max-width: 1200px) {
            .saldo-container { right: 15px; }
            .language-switcher { right: 220px; }
        }
        
        @media (max-width: 992px) {
            .saldo-container { top: 80px; right: 15px; }
            .language-switcher { top: 80px; right: 15px; }
            .admin-status { top: 80px; left: 15px; }
            .header { padding-top: 140px; }
            .features-grid, .price-grid, .payment-methods-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .summary-grid { grid-template-columns: 1fr; }
            .vip-update-info-grid { grid-template-columns: 1fr; }
        }
        
        @media (max-width: 768px) {
            .saldo-card { min-width: 180px; padding: 12px 20px; }
            .saldo-amount { font-size: 20px; }
            .deposit-btn { padding: 6px 12px; font-size: 11px; }
            .language-switcher { top: 80px; right: 15px; }
            .lang-btn { padding: 8px 15px; font-size: 12px; }
            .admin-status { padding: 10px 15px; font-size: 14px; }
            .header { padding-top: 140px; }
            .title { font-size: 36px; }
            .content-container { padding: 25px; }
            .features-grid, .price-grid, .payment-methods-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            .uid-buttons, .popup-buttons {
                flex-direction: column;
                align-items: center;
            }
            .uid-copy-btn, .change-uid-btn, .popup-btn {
                min-width: 100%;
            }
            .action-buttons { grid-template-columns: 1fr; }
            .update-stats { grid-template-columns: 1fr; }
            .chat-container { height: 600px; padding: 25px; }
            .chat-input-row { flex-wrap: wrap; }
            .chat-attachment-btn, .chat-send-btn { width: 100%; height: 60px; }
            .chat-input { width: 100%; }
            .deposit-content { padding: 30px; }
            .amount-presets { grid-template-columns: repeat(2, 1fr); }
            .vip-update-content { padding: 30px; }
            .vip-update-title { font-size: 36px; }
            .vip-update-header { flex-direction: column; text-align: center; }
            .vip-update-link-container { flex-direction: column; }
            .vip-update-copy-btn { width: 100%; }
            .maintenance-page-title { font-size: 36px; }
            .maintenance-page-timer { font-size: 48px; }
            .vip-global-update-title { font-size: 42px; }
            .vip-global-update-content { padding: 40px 30px; }
            .gallery-content, .transaction-content {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 480px) {
            .saldo-card { min-width: 160px; padding: 10px 15px; }
            .saldo-icon { width: 40px; height: 40px; font-size: 20px; }
            .saldo-amount { font-size: 18px; }
            .header { padding-top: 150px; }
            .title { font-size: 28px; }
            .uid-value { font-size: 20px; padding: 20px; }
            .price-amount { font-size: 28px; }
            .counter-display { font-size: 36px; }
            .update-content, .deposit-content, .uid-popup-content { padding: 25px; }
            .update-icon { font-size: 50px; }
            .stat-value { font-size: 22px; }
            .amount-presets { grid-template-columns: 1fr; }
            .vip-update-title { font-size: 28px; }
            .vip-update-info-value { font-size: 18px; }
            .maintenance-page-title { font-size: 28px; }
            .maintenance-page-timer { font-size: 36px; }
            .vip-global-update-title { font-size: 32px; }
            .vip-global-update-icon { font-size: 70px; }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <!-- ANIMATED SHARINGAN BACKGROUND -->
    <div class="sharingan-background">
        <div class="animated-background"></div>
        <div class="sharingan-container">
            <div class="sharingan">
                <div class="sharingan-inner"></div>
                <div class="sharingan-tomoe"></div>
                <div class="sharingan-tomoe"></div>
                <div class="sharingan-tomoe"></div>
            </div>
        </div>
    </div>
    
    <!-- SALDO DISPLAY -->
    <div class="saldo-container" id="saldoContainer">
        <div class="saldo-card">
            <div class="saldo-icon">
                <i class="fas fa-wallet"></i>
            </div>
            <div class="saldo-info">
                <div class="saldo-label">SALDO ANDA</div>
                <div class="saldo-amount" id="saldoAmount">Rp 0</div>
                <button class="deposit-btn" onclick="showDepositPopup()">
                    <i class="fas fa-plus-circle"></i> DEPOSIT
                </button>
            </div>
        </div>
    </div>
    
    <!-- LANGUAGE SWITCHER -->
    <div class="language-switcher">
        <button class="lang-btn" onclick="toggleLanguageDropdown()">
            <i class="fas fa-globe"></i>
            <span id="currentLang">ID</span>
            <i class="fas fa-chevron-down"></i>
        </button>
        <div class="lang-dropdown" id="langDropdown">
            <div class="lang-option" onclick="changeLanguage('id')">
                <img src="https://flagcdn.com/w20/id.png" class="lang-flag" alt="Indonesia">
                <span class="lang-text" id="langId">Indonesia</span>
            </div>
            <div class="lang-option" onclick="changeLanguage('en')">
                <img src="https://flagcdn.com/w20/gb.png" class="lang-flag" alt="English">
                <span class="lang-text" id="langEn">English</span>
            </div>
            <div class="lang-option" onclick="changeLanguage('es')">
                <img src="https://flagcdn.com/w20/es.png" class="lang-flag" alt="EspaÃ±ol">
                <span class="lang-text" id="langEs">EspaÃ±ol</span>
            </div>
            <div class="lang-option" onclick="changeLanguage('ar')">
                <img src="https://flagcdn.com/w20/sa.png" class="lang-flag" alt="Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©">
                <span class="lang-text" id="langAr">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</span>
            </div>
        </div>
    </div>
    
    <!-- ADMIN ONLINE STATUS -->
    <div class="admin-status" id="adminStatus">
        <div class="status-indicator" id="statusIndicator"></div>
        <span class="status-text" id="statusText">Admin: Offline</span>
    </div>
    
    <!-- DEPOSIT POPUP -->
    <div class="deposit-popup" id="depositPopup">
        <div class="deposit-content">
            <div class="popup-header">
                <h1 class="popup-title">ðŸ’° DEPOSIT SALDO</h1>
                <p class="popup-subtitle">Isi data deposit dengan lengkap, minimal deposit Rp 20.000</p>
            </div>
            
            <!-- DEPOSIT FORM -->
            <div class="deposit-form">
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-user"></i> NAMA PENGIRIM <span style="color: #ff0000;">*</span>
                    </label>
                    <input type="text" id="depositNama" class="form-input" placeholder="Masukkan nama lengkap pengirim" maxlength="100" autocomplete="off">
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-mobile-alt"></i> NO. E-WALLET <span style="color: #ff0000;">*</span>
                    </label>
                    <input type="text" id="depositNoEwallet" class="form-input" placeholder="Masukkan nomor e-wallet pengirim" maxlength="50" autocomplete="off">
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-credit-card"></i> METODE PEMBAYARAN <span style="color: #ff0000;">*</span>
                    </label>
                    <div class="payment-methods-grid">
                        <div class="payment-method-item" onclick="selectPaymentMethod('DANA', '0881011076305', this)">
                            <div class="payment-method-icon"><i class="fas fa-mobile-alt"></i></div>
                            <div class="payment-method-name">DANA</div>
                            <div class="payment-method-number">0881011076305</div>
                        </div>
                        <div class="payment-method-item" onclick="selectPaymentMethod('GOPAY', '083126486017', this)">
                            <div class="payment-method-icon"><i class="fas fa-wallet"></i></div>
                            <div class="payment-method-name">GOPAY</div>
                            <div class="payment-method-number">083126486017</div>
                        </div>
                        <div class="payment-method-item" onclick="selectPaymentMethod('QRIS', 'CONTACT ADMIN', this)">
                            <div class="payment-method-icon"><i class="fas fa-qrcode"></i></div>
                            <div class="payment-method-name">QRIS</div>
                            <div class="payment-method-number">CONTACT ADMIN</div>
                        </div>
                        <div class="payment-method-item" onclick="selectPaymentMethod('PAYPAL', 'CONTACT ADMIN', this)">
                            <div class="payment-method-icon"><i class="fab fa-paypal"></i></div>
                            <div class="payment-method-name">PAYPAL</div>
                            <div class="payment-method-number">CONTACT ADMIN</div>
                        </div>
                    </div>
                    <input type="hidden" id="depositMetode">
                    <input type="hidden" id="depositNomorTujuan">
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-coins"></i> JUMLAH DEPOSIT <span style="color: #ff0000;">*</span>
                        <span style="color: #ffc107; margin-left: 10px; font-size: 14px;">(Minimal Rp 20.000)</span>
                    </label>
                    
                    <div class="amount-presets">
                        <div class="amount-preset" onclick="setDepositAmount(20000, this)">Rp 20.000</div>
                        <div class="amount-preset" onclick="setDepositAmount(50000, this)">Rp 50.000</div>
                        <div class="amount-preset" onclick="setDepositAmount(100000, this)">Rp 100.000</div>
                        <div class="amount-preset" onclick="setDepositAmount(200000, this)">Rp 200.000</div>
                        <div class="amount-preset" onclick="setDepositAmount(500000, this)">Rp 500.000</div>
                        <div class="amount-preset" onclick="setDepositAmount(1000000, this)">Rp 1.000.000</div>
                    </div>
                    
                    <input type="number" id="depositJumlah" class="form-input" placeholder="Contoh: 50000" min="20000" step="1000" onchange="validateDepositAmount()" onkeyup="validateDepositAmount()">
                    
                    <div class="min-deposit-note">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>Minimal deposit <strong>Rp 20.000</strong>. Isi jumlah sesuai dengan transfer Anda.</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-sticky-note"></i> CATATAN (OPSIONAL)
                        <span class="optional-badge">OPSIONAL</span>
                    </label>
                    <input type="text" id="depositCatatan" class="form-input" placeholder="Contoh: Transfer dari Bank BCA / Catatan tambahan" maxlength="200">
                </div>
                
                <div class="deposit-summary">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                        <span style="color: #ffc107; font-weight: bold; font-size: 20px;">
                            <i class="fas fa-clipboard-check"></i> RINGKASAN DEPOSIT
                        </span>
                    </div>
                    <div class="summary-row">
                        <span class="summary-label"><i class="fas fa-user"></i> Nama Pengirim:</span>
                        <span class="summary-value" id="summaryNama">-</span>
                    </div>
                    <div class="summary-row">
                        <span class="summary-label"><i class="fas fa-mobile-alt"></i> No. E-Wallet:</span>
                        <span class="summary-value" id="summaryNoEwallet">-</span>
                    </div>
                    <div class="summary-row">
                        <span class="summary-label"><i class="fas fa-credit-card"></i> Metode:</span>
                        <span class="summary-value" id="summaryMetode">-</span>
                    </div>
                    <div class="summary-row">
                        <span class="summary-label"><i class="fas fa-arrow-right"></i> Tujuan:</span>
                        <span class="summary-value" id="summaryTujuan">-</span>
                    </div>
                    <div class="summary-row">
                        <span class="summary-label"><i class="fas fa-coins"></i> Jumlah:</span>
                        <span class="summary-value" id="summaryJumlah">Rp 0</span>
                    </div>
                    <div class="summary-row">
                        <span class="summary-label"><i class="fas fa-sticky-note"></i> Catatan:</span>
                        <span class="summary-value" id="summaryCatatan">-</span>
                    </div>
                </div>
            </div>
            
            <div class="popup-buttons">
                <button class="popup-btn popup-btn-secondary" onclick="closeDepositPopup()">
                    <i class="fas fa-times"></i> BATAL
                </button>
                <button class="popup-btn popup-btn-primary" onclick="submitDeposit()" id="submitDepositBtn">
                    <i class="fas fa-paper-plane"></i> KIRIM DEPOSIT
                </button>
            </div>
        </div>
    </div>
    
    <!-- VIP UPDATE POPUP -->
    <div class="vip-update-popup" id="vipUpdatePopup">
        <div class="vip-update-content">
            <div class="vip-update-header">
                <div class="vip-update-icon">
                    <i class="fas fa-crown"></i>
                </div>
                <div>
                    <div class="vip-update-title" id="vipUpdateTitle">VIP UPDATE</div>
                    <span class="vip-update-badge">VIP EXCLUSIVE</span>
                </div>
            </div>
            
            <div class="vip-update-info-grid">
                <div class="vip-update-info-item">
                    <div class="vip-update-info-label">
                        <i class="fas fa-tag"></i> VERSION FILE
                    </div>
                    <div class="vip-update-info-value" id="vipUpdateVersion">v1.0.0</div>
                </div>
                <div class="vip-update-info-item">
                    <div class="vip-update-info-label">
                        <i class="fas fa-clock"></i> PEMBARUAN
                    </div>
                    <div class="vip-update-info-value" id="vipUpdateTime">Just Now</div>
                </div>
            </div>
            
            <div class="vip-update-description">
                <div class="vip-update-description-title">
                    <i class="fas fa-file-alt"></i> DESKRIPSI UPDATE
                </div>
                <div class="vip-update-description-text" id="vipUpdateDescription">
                    -
                </div>
            </div>
            
            <div class="vip-update-link-container">
                <div class="vip-update-link" id="vipUpdateLink">
                    https://www.mediafire.com/folder/example
                </div>
                <button class="vip-update-copy-btn" onclick="copyVipUpdateLink()">
                    <i class="fas fa-copy"></i> SALIN LINK
                </button>
            </div>
            
            <div class="vip-update-footer">
                <button class="vip-update-close-btn" onclick="closeVipUpdatePopup()">
                    <i class="fas fa-check-circle"></i> TUTUP
                </button>
            </div>
        </div>
    </div>
    
    <!-- MAINTENANCE PAGE -->
    <div class="maintenance-page" id="maintenancePage">
        <div class="maintenance-page-content">
            <div class="maintenance-page-icon">
                <i class="fas fa-tools"></i>
            </div>
            <h1 class="maintenance-page-title" id="maintenancePageTitle">MAINTENANCE MODE</h1>
            <p class="maintenance-page-message" id="maintenancePageMessage">
                Sistem VIP Files sedang dalam pemeliharaan. Kami sedang melakukan pembaruan untuk pengalaman yang lebih baik.
            </p>
            
            <div class="maintenance-page-timer-container">
                <div class="maintenance-page-timer-title">â³ Estimasi Waktu Selesai:</div>
                <div class="maintenance-page-timer" id="maintenancePageTimer">00:00:00</div>
                <div class="maintenance-page-progress">
                    <div class="maintenance-page-progress-bar" id="maintenancePageProgressBar"></div>
                </div>
            </div>
            
            <div class="maintenance-page-info">
                <div class="maintenance-page-info-item">
                    <div class="maintenance-page-info-label">Dimulai Pada</div>
                    <div class="maintenance-page-info-value" id="maintenancePageStartTime">-</div>
                </div>
                <div class="maintenance-page-info-item">
                    <div class="maintenance-page-info-label">Estimasi Selesai</div>
                    <div class="maintenance-page-info-value" id="maintenancePageEndTime">-</div>
                </div>
                <div class="maintenance-page-info-item">
                    <div class="maintenance-page-info-label">Total Durasi</div>
                    <div class="maintenance-page-info-value" id="maintenancePageDuration">-</div>
                </div>
            </div>
            
            <div class="maintenance-page-additional" id="maintenancePageAdditional">
                <i class="fas fa-clock"></i> Terima kasih atas kesabaran Anda. Sistem akan kembali normal secepatnya.
            </div>
            
            <button class="maintenance-page-refresh-btn" onclick="checkMaintenanceStatus()">
                <i class="fas fa-sync-alt"></i> Refresh Status
            </button>
        </div>
    </div>
    
    <!-- VIP GLOBAL UPDATE POPUP -->
    <div class="vip-global-update-popup" id="vipGlobalUpdatePopup">
        <div class="vip-global-update-content">
            <div class="vip-global-update-header">
                <div class="vip-global-update-icon">
                    <i class="fas fa-crown"></i>
                </div>
                <div class="vip-global-update-title-section">
                    <div class="vip-global-update-title" id="vipGlobalUpdateTitle">VIP UPDATE TERSEDIA!</div>
                    <span class="vip-global-update-badge">VIP EXCLUSIVE</span>
                </div>
            </div>
            
            <div class="vip-global-update-grid">
                <div class="vip-global-update-item">
                    <div class="vip-global-update-item-label">
                        <i class="fas fa-tag"></i> VERSION FILE
                    </div>
                    <div class="vip-global-update-item-value" id="vipGlobalUpdateVersion">v2.5.0</div>
                </div>
                <div class="vip-global-update-item">
                    <div class="vip-global-update-item-label">
                        <i class="fas fa-calendar-alt"></i> TANGGAL UPDATE
                    </div>
                    <div class="vip-global-update-item-value" id="vipGlobalUpdateDate">-</div>
                </div>
                <div class="vip-global-update-item">
                    <div class="vip-global-update-item-label">
                        <i class="fas fa-clock"></i> WAKTU UPDATE
                    </div>
                    <div class="vip-global-update-item-value" id="vipGlobalUpdateTime">-</div>
                </div>
                <div class="vip-global-update-item">
                    <div class="vip-global-update-item-label">
                        <i class="fas fa-database"></i> FILE SIZE
                    </div>
                    <div class="vip-global-update-item-value" id="vipGlobalUpdateSize">~15 MB</div>
                </div>
            </div>
            
            <div class="vip-global-update-description">
                <div class="vip-global-update-description-title">
                    <i class="fas fa-file-alt"></i> DESKRIPSI UPDATE
                </div>
                <div class="vip-global-update-description-text" id="vipGlobalUpdateDescription">
                    -
                </div>
            </div>
            
            <div class="vip-global-update-link-container">
                <div class="vip-global-update-link" id="vipGlobalUpdateLink">
                    https://www.mediafire.com/folder/example
                </div>
                <button class="vip-global-update-copy-btn" onclick="copyVipGlobalUpdateLink()">
                    <i class="fas fa-copy"></i> SALIN LINK
                </button>
            </div>
            
            <div class="vip-global-update-footer">
                <button class="vip-global-update-close-btn" onclick="closeVipGlobalUpdatePopup()">
                    <i class="fas fa-check-circle"></i> TUTUP
                </button>
            </div>
        </div>
    </div>
    
    <!-- UID POPUP -->
    <div class="uid-popup active" id="uidPopup">
        <div class="uid-popup-content">
            <div class="popup-header">
                <h1 class="popup-title">ðŸ‘‘ VIP FILES ðŸ‘‘</h1>
                <p class="popup-subtitle">Masukkan UID Anda untuk mulai</p>
            </div>
            
            <div class="uid-input-section active" id="existingUidSection">
                <div class="input-group">
                    <label for="existingUidInput" class="input-label">
                        <i class="fas fa-key"></i> MASUKKAN UID ANDA
                    </label>
                    <input type="text" id="existingUidInput" class="uid-input" placeholder="Contoh: VIP_ABC123XYZ" maxlength="50">
                    <div class="error-message" id="existingUidError">
                        <i class="fas fa-exclamation-circle"></i> UID tidak valid atau tidak ditemukan
                    </div>
                    <div class="success-message" id="existingUidSuccess">
                        <i class="fas fa-check-circle"></i> UID berhasil ditemukan! Memuat data...
                    </div>
                </div>
                
                <div class="popup-buttons">
                    <button class="popup-btn popup-btn-primary" onclick="loadExistingUid()">
                        <i class="fas fa-sign-in-alt"></i> MASUK DENGAN UID
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- MAIN CONTAINER -->
    <div class="container" id="mainContainer">
        <div class="header">
            <h1 class="title">ðŸ‘‘ VIP FILES ðŸ‘‘</h1>
            <p class="subtitle">Premium Files & Tools for Gaming</p>
        </div>
        
        <div class="content-container">
            <h1>ðŸŽ« VIP FILES ðŸŽ«</h1>
            <p style="text-align: center; margin-bottom: 30px; color: #ff6b6b; font-size: 20px;">
                Premium files dan tools untuk pengalaman gaming terbaik
            </p>
            
            <!-- UID DISPLAY -->
            <div class="uid-container">
                <div class="uid-title">
                    <i class="fas fa-id-card"></i> YOUR UNIQUE ID (UID)
                </div>
                <div class="uid-value" id="uidValue" onclick="copyUidToClipboard()"></div>
                <div class="uid-info">
                    <span>Status:</span> <span id="uidStatus" style="color: #4caf50;">Active</span> | 
                    <span>Dibuat:</span> <span id="uidCreated">Loading...</span>
                </div>
                <div class="uid-buttons">
                    <button class="uid-copy-btn" onclick="copyUidToClipboard()">
                        <i class="fas fa-copy"></i> SALIN UID
                    </button>
                    <button class="change-uid-btn" onclick="showUidPopup()">
                        <i class="fas fa-exchange-alt"></i> GANTI UID
                    </button>
                </div>
            </div>
            
            <!-- UPDATE COUNTER -->
            <div class="update-counter" id="updateCounter">
                <div class="counter-title">
                    <i class="fas fa-sync-alt"></i> PEMBARUAN VIP FILES
                </div>
                <div class="counter-display" id="updateCounterDisplay">0/0</div>
                <div class="counter-progress">
                    <div class="counter-progress-bar" id="updateProgressBar"></div>
                </div>
                <div class="counter-info" id="updateCounterInfo">
                    Anda memiliki 0 pembaruan tersisa dari total 0 pembaruan
                </div>
            </div>
            
            <!-- PURCHASE HISTORY -->
            <div class="purchase-history" id="purchaseHistory">
                <div class="history-title">
                    <i class="fas fa-history"></i> RIWAYAT PEMBELIAN
                </div>
                <div class="history-list" id="historyList">
                    <div class="no-data">Belum ada riwayat pembelian</div>
                </div>
            </div>
            
            <!-- NEW: DISCOUNT CODE SECTION -->
            <div class="discount-section">
                <div class="discount-title">
                    <i class="fas fa-ticket-alt"></i> KODE DISKON
                </div>
                <div class="discount-input-group">
                    <input type="text" id="discountCode" class="discount-input" placeholder="Masukkan kode diskon" maxlength="50">
                    <button class="discount-apply-btn" onclick="applyDiscountCode()" id="applyDiscountBtn">
                        <i class="fas fa-check"></i> TERAPKAN
                    </button>
                </div>
                <div class="discount-info" id="discountInfo">
                    <div class="discount-detail">
                        <span class="discount-label">Kode Diskon:</span>
                        <span class="discount-value" id="discountCodeDisplay">-</span>
                    </div>
                    <div class="discount-detail">
                        <span class="discount-label">Diskon:</span>
                        <span class="discount-value" id="discountPercentageDisplay">-</span>
                    </div>
                    <div class="discount-detail">
                        <span class="discount-label">Berlaku s/d:</span>
                        <span class="discount-value" id="discountExpiryDisplay">-</span>
                    </div>
                    <div class="discount-detail">
                        <span class="discount-label">Min. Pembelian:</span>
                        <span class="discount-value" id="discountMinPurchaseDisplay">-</span>
                    </div>
                    <div class="discount-detail">
                        <span class="discount-label">Harga Asli:</span>
                        <span class="discount-value original" id="originalPriceDisplay">Rp 0</span>
                    </div>
                    <div class="discount-detail">
                        <span class="discount-label">Potongan:</span>
                        <span class="discount-value" id="discountAmountDisplay">Rp 0</span>
                    </div>
                    <div class="discount-detail">
                        <span class="discount-label">Harga Setelah Diskon:</span>
                        <span class="discount-value" style="color: #4caf50; font-size: 20px;" id="finalPriceDisplay">Rp 0</span>
                    </div>
                </div>
            </div>
            
            <!-- NEW: PACKAGE NAME INPUT SECTION -->
            <div class="package-section">
                <div class="package-title">
                    <i class="fas fa-cube"></i> PACKAGE NAME
                </div>
                <div class="package-input-group">
                    <input type="text" id="packageName" class="package-input" placeholder="Contoh: com.netease.newspike" maxlength="100">
                    <div class="package-info">
                        <i class="fas fa-info-circle"></i> Masukkan nama package game/file yang ingin dibeli
                    </div>
                </div>
            </div>
            
            <!-- VIP FEATURES -->
            <h2 style="color: #ff0000; text-align: center; margin: 40px 0 30px; font-size: 32px; text-shadow: 0 0 20px rgba(255, 0, 0, 0.5);">
                <i class="fas fa-gem"></i> VIP FEATURES
            </h2>
            
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-crosshairs"></i></div>
                    <div class="feature-name">AimAssist</div>
                    <div class="feature-desc">Auto aiming dengan akurasi tinggi</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-bullseye"></i></div>
                    <div class="feature-name">AimLock</div>
                    <div class="feature-desc">Target terkunci otomatis</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-skull"></i></div>
                    <div class="feature-name">AimHead</div>
                    <div class="feature-desc">Headshot otomatis 100%</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-water"></i></div>
                    <div class="feature-name">AimFlow</div>
                    <div class="feature-desc">Aiming smooth seperti air</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-tachometer-alt"></i></div>
                    <div class="feature-name">FiksLag</div>
                    <div class="feature-desc">Minimalkan lag & delay</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-shield-alt"></i></div>
                    <div class="feature-name">RecoilReduction</div>
                    <div class="feature-desc">Reduksi recoil senjata</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-satellite-dish"></i></div>
                    <div class="feature-name">BulletTracking</div>
                    <div class="feature-desc">Peluru melacak target</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-bolt"></i></div>
                    <div class="feature-name">HighDamage</div>
                    <div class="feature-desc">Damage maksimal 100%</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-chart-line"></i></div>
                    <div class="feature-name">FpsBooster</div>
                    <div class="feature-desc">Tingkatkan FPS game</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-unlock-alt"></i></div>
                    <div class="feature-name">Bypass</div>
                    <div class="feature-desc">Bypass security system</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-shield"></i></div>
                    <div class="feature-name">NoBaned</div>
                    <div class="feature-desc">Anti-ban protection</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-save"></i></div>
                    <div class="feature-name">Save Account</div>
                    <div class="feature-desc">Backup & restore account</div>
                </div>
            </div>
            
            <!-- PRICE OPTIONS -->
            <h2 style="color: #ff0000; text-align: center; margin: 60px 0 40px; font-size: 32px; text-shadow: 0 0 20px rgba(255, 0, 0, 0.5);">
                <i class="fas fa-tags"></i> HARGA VIP FILES
            </h2>
            
            <div class="price-grid" id="vipPriceGrid">
                <div class="price-card" data-price="20000" data-updates="2" onclick="selectPriceCard(this, '20000', 'VIP 2X Update', '2X Pembaruan')">
                    <div class="price-icon"><i class="fas fa-gem"></i></div>
                    <div class="price-amount">Rp 20K</div>
                    <div class="price-duration">PAKET VIP</div>
                    <div class="price-updates">2X PEMBARUAN</div>
                    <div class="price-features">â€¢ All Features<br>â€¢ Update 2x<br>â€¢ Support 24/7<br>â€¢ Lifetime File Access</div>
                </div>
                <div class="price-card" data-price="35000" data-updates="4" onclick="selectPriceCard(this, '35000', 'VIP 4X Update', '4X Pembaruan')">
                    <div class="price-icon"><i class="fas fa-crown"></i></div>
                    <div class="price-amount">Rp 35K</div>
                    <div class="price-duration">PAKET VIP</div>
                    <div class="price-updates">4X PEMBARUAN</div>
                    <div class="price-features">â€¢ All Features<br>â€¢ Update 4x<br>â€¢ Priority Support<br>â€¢ Lifetime File Access</div>
                </div>
                <div class="price-card" data-price="50000" data-updates="6" onclick="selectPriceCard(this, '50000', 'VIP 6X Update', '6X Pembaruan')">
                    <div class="price-icon"><i class="fas fa-star"></i></div>
                    <div class="price-amount">Rp 50K</div>
                    <div class="price-duration">PAKET VIP</div>
                    <div class="price-updates">6X PEMBARUAN</div>
                    <div class="price-features">â€¢ All Features<br>â€¢ Update 6x<br>â€¢ VIP Support<br>â€¢ Lifetime File Access</div>
                </div>
                <div class="price-card" data-price="100000" data-updates="15" onclick="selectPriceCard(this, '100000', 'VIP 15X Update', '15X Pembaruan')">
                    <div class="price-icon"><i class="fas fa-trophy"></i></div>
                    <div class="price-amount">Rp 100K</div>
                    <div class="price-duration">PAKET VIP</div>
                    <div class="price-updates">15X PEMBARUAN</div>
                    <div class="price-features">â€¢ All Features<br>â€¢ Update 15x<br>â€¢ Premium Support<br>â€¢ Lifetime File Access</div>
                </div>
                <div class="price-card" data-price="150000" data-updates="30" onclick="selectPriceCard(this, '150000', 'VIP 30X Update', '30X Pembaruan')">
                    <div class="price-icon"><i class="fas fa-award"></i></div>
                    <div class="price-amount">Rp 150K</div>
                    <div class="price-duration">PAKET VIP</div>
                    <div class="price-updates">30X PEMBARUAN</div>
                    <div class="price-features">â€¢ All Features<br>â€¢ Update 30x<br>â€¢ VIP+ Support<br>â€¢ Lifetime File Access</div>
                </div>
                <div class="price-card" data-price="200000" data-updates="unlimited" onclick="selectPriceCard(this, '200000', 'VIP Unlimited', 'Unlimited Pembaruan')">
                    <div class="price-icon"><i class="fas fa-infinity"></i></div>
                    <div class="price-amount">Rp 200K</div>
                    <div class="price-duration">PAKET VIP</div>
                    <div class="price-updates">UNLIMITED</div>
                    <div class="price-features">â€¢ All Features<br>â€¢ Update Unlimited<br>â€¢ Ultimate Support<br>â€¢ Lifetime File Access</div>
                </div>
            </div>
            
            <!-- ORDER SUMMARY -->
            <div class="order-summary">
                <div class="summary-title">
                    <i class="fas fa-clipboard-check"></i> RINGKASAN ORDER
                </div>
                <div class="summary-grid">
                    <div class="summary-item">
                        <div class="summary-label"><i class="fas fa-box"></i> Paket VIP</div>
                        <div class="summary-value" id="summaryPackage">-</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label"><i class="fas fa-tag"></i> Harga</div>
                        <div class="summary-value" id="summaryPrice">-</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label"><i class="fas fa-sync-alt"></i> Jumlah Pembaruan</div>
                        <div class="summary-value" id="summaryUpdates">-</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label"><i class="fas fa-cube"></i> Package Name</div>
                        <div class="summary-value" id="summaryPackageName">-</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label"><i class="fas fa-clock"></i> Waktu Pembelian</div>
                        <div class="summary-value" id="summaryTime">-</div>
                    </div>
                </div>
            </div>
            
            <!-- ACTION BUTTONS -->
            <div class="action-buttons">
                <button class="action-btn submit-btn" id="submitBtn" onclick="submitOrder()">
                    <i class="fas fa-shopping-cart"></i> BELI VIP SEKARANG
                </button>
                <button class="action-btn reset-btn" onclick="resetForm()">
                    <i class="fas fa-redo"></i> RESET FORM
                </button>
            </div>
            
            <!-- ==================== FILE GALLERY - PHOTO TRANSACTION & FILE ==================== -->
            <div class="file-gallery" id="fileGallery">
                <div class="gallery-title">
                    <i class="fas fa-images"></i> GALERI FILE & TRANSAKSI
                </div>
                
                <div class="gallery-tabs">
                    <button class="gallery-tab active" onclick="switchGalleryTab('files')">
                        <i class="fas fa-folder"></i> SEMUA FILE
                    </button>
                    <button class="gallery-tab" onclick="switchGalleryTab('transactions')">
                        <i class="fas fa-credit-card"></i> TRANSAKSI
                    </button>
                    <button class="gallery-tab" onclick="switchGalleryTab('photos')">
                        <i class="fas fa-camera"></i> FOTO
                    </button>
                </div>
                
                <div id="galleryFiles" class="gallery-content">
                    <div class="no-data">Memuat file...</div>
                </div>
                
                <div id="galleryTransactions" class="gallery-content" style="display: none;">
                    <div class="no-data">Memuat transaksi...</div>
                </div>
                
                <div id="galleryPhotos" class="gallery-content" style="display: none;">
                    <div class="no-data">Memuat foto...</div>
                </div>
            </div>
            
            <!-- ==================== TRANSACTION GALLERY - NEW ==================== -->
            <div class="transaction-gallery" id="transactionGallery">
                <div class="transaction-title">
                    <i class="fas fa-receipt"></i> TRANSAKSI TERBARU
                </div>
                <div class="transaction-content" id="transactionContent">
                    <div class="no-data">Belum ada transaksi</div>
                </div>
            </div>
            
            <!-- ==================== CHAT WITH ADMIN - ENHANCED ==================== -->
            <div class="chat-container">
                <div class="chat-header">
                    <div class="chat-title">
                        <i class="fas fa-comments"></i> CHAT DENGAN ADMIN
                    </div>
                    <div class="chat-status" id="chatStatus">
                        <i class="fas fa-circle" style="color: #4caf50;"></i> TERHUBUNG
                    </div>
                </div>
                
                <div class="chat-messages" id="chatMessages">
                    <div class="no-data">Memuat riwayat chat...</div>
                </div>
                
                <div class="chat-input-container">
                    <div class="chat-input-row">
                        <input type="file" id="fileInput" style="display: none;" onchange="uploadFile()" accept="*/*">
                        <button class="chat-attachment-btn" onclick="document.getElementById('fileInput').click()" id="attachmentBtn">
                            <i class="fas fa-paperclip"></i>
                        </button>
                        <input type="text" class="chat-input" id="chatInput" placeholder="Ketik pesan untuk admin..." onkeypress="handleChatEnter(event)" disabled>
                        <button class="chat-send-btn" id="chatSendBtn" onclick="sendMessage()" disabled>
                            <i class="fas fa-paper-plane"></i> KIRIM
                        </button>
                    </div>
                    <div id="uploadProgress" style="display: none;">
                        <div class="upload-progress">
                            <div class="upload-progress-bar" id="uploadProgressBar"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>&copy; 2026 VIP Files - ZYNICONE01 Store. All rights reserved.</p>
        </div>
    </div>
    
    <!-- TOAST -->
    <div class="toast" id="toast"></div>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-storage-compat.js"></script>
    
    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyD9Gfb83b8QhsImdpun5fPuSAcoQ5UxcXI",
            authDomain: "admincontrol-485eb.firebaseapp.com",
            databaseURL: "https://admincontrol-485eb-default-rtdb.firebaseio.com",
            projectId: "admincontrol-485eb",
            storageBucket: "admincontrol-485eb.firebasestorage.app",
            messagingSenderId: "1051199942261",
            appId: "1:1051199942261:web:ccbd0947ce39b2e8c4923c",
            measurementId: "G-DWT8XYX3K9"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const storage = firebase.storage();
        
        // Global variables
        let currentUID = '';
        let currentSaldo = 0;
        let selectedPrice = 0;
        let selectedUpdates = 0;
        let selectedPackageName = '';
        let selectedPackageDisplay = '';
        let currentOrderData = {};
        let chatListener = null;
        let saldoListener = null;
        let updateListener = null;
        let purchaseListener = null;
        let vipUpdateListener = null;
        let currentLanguage = 'id';
        let adminOnline = false;
        let maintenanceTimerInterval = null;
        let translationAPI = 'https://deepseek.com';
        let maintenanceStartTime = null;
        let maintenanceEndTime = null;
        let maintenanceTotalDuration = 0;
        
        // NEW: Discount variables
        let activeDiscount = null;
        let discountedPrice = 0;
        let originalPrice = 0;
        
        // Deposit variables
        let selectedPaymentMethod = '';
        let selectedPaymentNumber = '';
        
        // File tracking untuk gallery
        let allFiles = [];
        let allTransactions = [];
        let allPhotos = [];
        
        // Track update IDs yang sudah diproses
        let processedUpdates = new Set();
        
        // Translation dictionary
        const translations = {
            'id': {
                'saldo_anda': 'SALDO ANDA',
                'deposit': 'DEPOSIT',
                'vip_files': 'VIP FILES',
                'premium_files': 'Premium Files & Tools for Gaming',
                'uid_anda': 'YOUR UNIQUE ID (UID)',
                'status': 'Status',
                'dibuat': 'Dibuat',
                'salin_uid': 'SALIN UID',
                'ganti_uid': 'GANTI UID',
                'pembaruan_vip': 'PEMBARUAN VIP FILES',
                'riwayat_pembelian': 'RIWAYAT PEMBELIAN',
                'vip_features': 'VIP FEATURES',
                'harga_vip': 'HARGA VIP FILES',
                'ringkasan_order': 'RINGKASAN ORDER',
                'paket_vip': 'Paket VIP',
                'harga': 'Harga',
                'jumlah_pembaruan': 'Jumlah Pembaruan',
                'waktu_pembelian': 'Waktu Pembelian',
                'beli_vip': 'BELI VIP SEKARANG',
                'reset_form': 'RESET FORM',
                'chat_admin': 'CHAT DENGAN ADMIN',
                'terhubung': 'TERHUBUNG',
                'ketik_pesan': 'Ketik pesan untuk admin...',
                'kirim': 'KIRIM',
                'admin_online': 'Admin: Online',
                'admin_offline': 'Admin: Offline',
                'masukkan_uid': 'MASUKKAN UID ANDA',
                'masuk_uid': 'MASUK DENGAN UID',
                'vip_update_title': 'VIP UPDATE',
                'version_file': 'VERSION FILE',
                'pembaruan': 'PEMBARUAN',
                'deskripsi_update': 'DESKRIPSI UPDATE',
                'salin_link': 'SALIN LINK',
                'tutup': 'TUTUP'
            },
            'en': {
                'saldo_anda': 'YOUR BALANCE',
                'deposit': 'DEPOSIT',
                'vip_files': 'VIP FILES',
                'premium_files': 'Premium Files & Tools for Gaming',
                'uid_anda': 'YOUR UNIQUE ID (UID)',
                'status': 'Status',
                'dibuat': 'Created',
                'salin_uid': 'COPY UID',
                'ganti_uid': 'CHANGE UID',
                'pembaruan_vip': 'VIP FILES UPDATES',
                'riwayat_pembelian': 'PURCHASE HISTORY',
                'vip_features': 'VIP FEATURES',
                'harga_vip': 'VIP FILES PRICES',
                'ringkasan_order': 'ORDER SUMMARY',
                'paket_vip': 'VIP Package',
                'harga': 'Price',
                'jumlah_pembaruan': 'Updates',
                'waktu_pembelian': 'Purchase Time',
                'beli_vip': 'BUY VIP NOW',
                'reset_form': 'RESET FORM',
                'chat_admin': 'CHAT WITH ADMIN',
                'terhubung': 'CONNECTED',
                'ketik_pesan': 'Type message for admin...',
                'kirim': 'SEND',
                'admin_online': 'Admin: Online',
                'admin_offline': 'Admin: Offline',
                'masukkan_uid': 'ENTER YOUR UID',
                'masuk_uid': 'LOGIN WITH UID',
                'vip_update_title': 'VIP UPDATE',
                'version_file': 'FILE VERSION',
                'pembaruan': 'UPDATE',
                'deskripsi_update': 'UPDATE DESCRIPTION',
                'salin_link': 'COPY LINK',
                'tutup': 'CLOSE'
            },
            'es': {
                'saldo_anda': 'TU SALDO',
                'deposit': 'DEPOSITAR',
                'vip_files': 'VIP FILES',
                'premium_files': 'Archivos y Herramientas Premium para Juegos',
                'uid_anda': 'TU ID ÃšNICO (UID)',
                'status': 'Estado',
                'dibuat': 'Creado',
                'salin_uid': 'COPIAR UID',
                'ganti_uid': 'CAMBIAR UID',
                'pembaruan_vip': 'ACTUALIZACIONES VIP',
                'riwayat_pembelian': 'HISTORIAL DE COMPRAS',
                'vip_features': 'CARACTERÃSTICAS VIP',
                'harga_vip': 'PRECIOS VIP',
                'ringkasan_order': 'RESUMEN DEL PEDIDO',
                'paket_vip': 'Paquete VIP',
                'harga': 'Precio',
                'jumlah_pembaruan': 'Actualizaciones',
                'waktu_pembelian': 'Fecha de Compra',
                'beli_vip': 'COMPRAR AHORA',
                'reset_form': 'REINICIAR',
                'chat_admin': 'CHAT CON ADMIN',
                'terhubung': 'CONECTADO',
                'ketik_pesan': 'Escribe mensaje para admin...',
                'kirim': 'ENVIAR',
                'admin_online': 'Admin: En lÃ­nea',
                'admin_offline': 'Admin: Desconectado',
                'masukkan_uid': 'INGRESA TU UID',
                'masuk_uid': 'INICIAR SESIÃ“N',
                'vip_update_title': 'ACTUALIZACIÃ“N VIP',
                'version_file': 'VERSIÃ“N',
                'pembaruan': 'ACTUALIZACIÃ“N',
                'deskripsi_update': 'DESCRIPCIÃ“N',
                'salin_link': 'COPIAR ENLACE',
                'tutup': 'CERRAR'
            },
            'ar': {
                'saldo_anda': 'Ø±ØµÙŠØ¯Ùƒ',
                'deposit': 'Ø¥ÙŠØ¯Ø§Ø¹',
                'vip_files': 'Ù…Ù„ÙØ§Øª VIP',
                'premium_files': 'Ù…Ù„ÙØ§Øª ÙˆØ£Ø¯ÙˆØ§Øª Ù…ØªÙ…ÙŠØ²Ø© Ù„Ù„Ø£Ù„Ø¹Ø§Ø¨',
                'uid_anda': 'Ø§Ù„Ù…Ø¹Ø±Ù Ø§Ù„ÙØ±ÙŠØ¯ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ',
                'status': 'Ø§Ù„Ø­Ø§Ù„Ø©',
                'dibuat': 'ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡',
                'salin_uid': 'Ù†Ø³Ø® Ø§Ù„Ù…Ø¹Ø±Ù',
                'ganti_uid': 'ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø¹Ø±Ù',
                'pembaruan_vip': 'ØªØ­Ø¯ÙŠØ«Ø§Øª VIP',
                'riwayat_pembelian': 'Ø³Ø¬Ù„ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª',
                'vip_features': 'Ù…ÙŠØ²Ø§Øª VIP',
                'harga_vip': 'Ø£Ø³Ø¹Ø§Ø± VIP',
                'ringkasan_order': 'Ù…Ù„Ø®Øµ Ø§Ù„Ø·Ù„Ø¨',
                'paket_vip': 'Ø¨Ø§Ù‚Ø© VIP',
                'harga': 'Ø§Ù„Ø³Ø¹Ø±',
                'jumlah_pembaruan': 'Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª',
                'waktu_pembelian': 'ÙˆÙ‚Øª Ø§Ù„Ø´Ø±Ø§Ø¡',
                'beli_vip': 'Ø§Ø´ØªØ± Ø§Ù„Ø¢Ù†',
                'reset_form': 'Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†',
                'chat_admin': 'Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ø¹ Ø§Ù„Ù…Ø´Ø±Ù',
                'terhubung': 'Ù…ØªØµÙ„',
                'ketik_pesan': 'Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ù…Ø´Ø±Ù...',
                'kirim': 'Ø¥Ø±Ø³Ø§Ù„',
                'admin_online': 'Ø§Ù„Ù…Ø´Ø±Ù: Ù…ØªØµÙ„',
                'admin_offline': 'Ø§Ù„Ù…Ø´Ø±Ù: ØºÙŠØ± Ù…ØªØµÙ„',
                'masukkan_uid': 'Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¹Ø±Ù Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ',
                'masuk_uid': 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
                'vip_update_title': 'ØªØ­Ø¯ÙŠØ« VIP',
                'version_file': 'Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…Ù„Ù',
                'pembaruan': 'ØªØ­Ø¯ÙŠØ«',
                'deskripsi_update': 'ÙˆØµÙ Ø§Ù„ØªØ­Ø¯ÙŠØ«',
                'salin_link': 'Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·',
                'tutup': 'Ø¥ØºÙ„Ø§Ù‚'
            }
        };
        
        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', function() {
            console.log('VIP Files Customer initialized');
            
            // Check maintenance status first
            checkMaintenanceStatus();
            
            // Load language
            const savedLang = localStorage.getItem('vip_files_lang') || 'id';
            changeLanguage(savedLang);
            
            // Monitor admin status
            monitorAdminStatus();
            
            // Check saved UID
            checkSavedUid();
            
            // Setup event listeners
            setupEventListeners();
            
            // Load processed updates from localStorage
            loadProcessedUpdates();
            
            // Listen for VIP updates with DUPLICATE CHECK
            setupVIPUpdateListener();
            
            // Monitor VIP global updates with DUPLICATE CHECK
            monitorVIPGlobalUpdates();
            
            // Setup file gallery listener
            setupFileGalleryListener();
            
            // Setup transaction gallery listener
            setupTransactionGalleryListener();
            
            // NEW: Setup discount listener
            setupDiscountListener();
        });
        
        function setupEventListeners() {
            const uidInput = document.getElementById('existingUidInput');
            if (uidInput) {
                uidInput.addEventListener('change', function() {
                    if (this.value.trim().startsWith('VIP_')) {
                        saveUidToLocalStorage(this.value.trim());
                    }
                });
                
                uidInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        loadExistingUid();
                    }
                });
            }
            
            document.addEventListener('click', function(event) {
                const langDropdown = document.getElementById('langDropdown');
                const langBtn = document.querySelector('.lang-btn');
                if (langDropdown && langBtn && !langBtn.contains(event.target) && !langDropdown.contains(event.target)) {
                    langDropdown.classList.remove('show');
                }
            });
            
            window.addEventListener('online', () => {
                showToast('Koneksi internet kembali');
            });
            
            window.addEventListener('offline', () => {
                showToast('Koneksi internet terputus');
            });
            
            window.addEventListener('beforeunload', cleanupListeners);
        }
        
        function cleanupListeners() {
            if (chatListener) chatListener();
            if (saldoListener) saldoListener();
            if (updateListener) updateListener();
            if (purchaseListener) purchaseListener();
            if (vipUpdateListener) vipUpdateListener();
            if (maintenanceTimerInterval) clearInterval(maintenanceTimerInterval);
        }
        
        function loadProcessedUpdates() {
            const saved = localStorage.getItem(`processed_updates_${currentUID}`);
            if (saved) {
                try {
                    processedUpdates = new Set(JSON.parse(saved));
                    console.log(`Loaded ${processedUpdates.size} processed updates`);
                } catch (e) {
                    console.error('Error loading processed updates:', e);
                    processedUpdates = new Set();
                }
            }
        }
        
        function saveProcessedUpdates() {
            localStorage.setItem(`processed_updates_${currentUID}`, JSON.stringify([...processedUpdates]));
        }
        
        // ==================== FUNGSI BAHASA ====================
        
        async function changeLanguage(lang) {
            currentLanguage = lang;
            document.getElementById('currentLang').textContent = lang.toUpperCase();
            toggleLanguageDropdown();
            localStorage.setItem('vip_files_lang', lang);
            
            // Translate via DeepSeek API
            try {
                await translatePageWithDeepSeek(lang);
            } catch (error) {
                console.error('Translation error:', error);
                applyTranslation(lang);
            }
            
            showToast(`Bahasa diubah ke ${getLanguageName(lang)}`);
        }
        
        function getLanguageName(lang) {
            const languages = {
                'id': 'Indonesia',
                'en': 'English',
                'es': 'EspaÃ±ol',
                'ar': 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©'
            };
            return languages[lang] || 'Indonesia';
        }
        
        async function translatePageWithDeepSeek(targetLang) {
            const elements = document.querySelectorAll('[data-translate]');
            const texts = [];
            const elementMap = [];
            
            elements.forEach((el, index) => {
                const originalText = el.textContent.trim();
                if (originalText) {
                    texts.push(originalText);
                    elementMap.push({ element: el, index });
                }
            });
            
            if (texts.length === 0) return;
            
            try {
                const response = await fetch(`${translationAPI}/translate`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        q: texts,
                        source: 'auto',
                        target: targetLang,
                        format: 'text'
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    elementMap.forEach((item, i) => {
                        if (data.translatedText && data.translatedText[i]) {
                            item.element.textContent = data.translatedText[i];
                        }
                    });
                } else {
                    applyTranslation(targetLang);
                }
            } catch (error) {
                console.error('DeepSeek API error:', error);
                applyTranslation(targetLang);
            }
        }
        
        function applyTranslation(lang) {
            const dict = translations[lang] || translations['id'];
            
            document.querySelectorAll('[data-translate]').forEach(el => {
                const key = el.getAttribute('data-translate');
                if (dict[key]) {
                    el.textContent = dict[key];
                }
            });
            
            document.querySelectorAll('[data-translate-placeholder]').forEach(el => {
                const key = el.getAttribute('data-translate-placeholder');
                if (dict[key]) {
                    el.placeholder = dict[key];
                }
            });
            
            document.querySelectorAll('[data-translate-title]').forEach(el => {
                const key = el.getAttribute('data-translate-title');
                if (dict[key]) {
                    el.title = dict[key];
                }
            });
        }
        
        function toggleLanguageDropdown() {
            document.getElementById('langDropdown').classList.toggle('show');
        }
        
        // ==================== NEW: DISCOUNT FUNCTIONS ====================
        
        function setupDiscountListener() {
            database.ref('discounts').on('child_added', (snapshot) => {
                console.log('Discount added:', snapshot.key);
            });
            
            database.ref('discounts').on('child_changed', (snapshot) => {
                if (activeDiscount && activeDiscount.code === snapshot.key) {
                    checkDiscountStatus();
                }
            });
        }
        
        async function applyDiscountCode() {
            const discountCode = document.getElementById('discountCode').value.trim().toUpperCase();
            
            if (!discountCode) {
                showToast('âŒ Masukkan kode diskon terlebih dahulu');
                return;
            }
            
            if (!selectedPrice || selectedPrice === 0) {
                showToast('âŒ Pilih paket VIP terlebih dahulu sebelum menggunakan diskon');
                return;
            }
            
            const applyBtn = document.getElementById('applyDiscountBtn');
            applyBtn.disabled = true;
            applyBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> MEMERIKSA...';
            
            try {
                const snapshot = await database.ref('discounts/' + discountCode).once('value');
                const discount = snapshot.val();
                
                if (!discount) {
                    showToast('âŒ Kode diskon tidak valid');
                    resetDiscount();
                    applyBtn.disabled = false;
                    applyBtn.innerHTML = '<i class="fas fa-check"></i> TERAPKAN';
                    return;
                }
                
                // Check if discount is active
                if (!discount.active) {
                    showToast('âŒ Kode diskon tidak aktif');
                    resetDiscount();
                    applyBtn.disabled = false;
                    applyBtn.innerHTML = '<i class="fas fa-check"></i> TERAPKAN';
                    return;
                }
                
                // Check expiry date
                const now = new Date();
                const expiryDate = new Date(discount.expiryDate);
                
                if (now > expiryDate) {
                    showToast('âŒ Kode diskon sudah kadaluarsa');
                    resetDiscount();
                    applyBtn.disabled = false;
                    applyBtn.innerHTML = '<i class="fas fa-check"></i> TERAPKAN';
                    return;
                }
                
                // Check minimum purchase requirement
                if (discount.minPurchase && selectedPrice < discount.minPurchase) {
                    showToast(`âŒ Kode diskon hanya berlaku untuk pembelian minimal Rp ${formatRupiah(discount.minPurchase)}`);
                    resetDiscount();
                    applyBtn.disabled = false;
                    applyBtn.innerHTML = '<i class="fas fa-check"></i> TERAPKAN';
                    return;
                }
                
                // Calculate discounted price
                originalPrice = selectedPrice;
                const discountAmount = Math.floor(selectedPrice * (discount.percentage / 100));
                discountedPrice = selectedPrice - discountAmount;
                
                // Store active discount
                activeDiscount = {
                    code: discountCode,
                    percentage: discount.percentage,
                    expiryDate: expiryDate,
                    minPurchase: discount.minPurchase || 0,
                    discountAmount: discountAmount
                };
                
                // Update UI
                document.getElementById('discountInfo').classList.add('active');
                document.getElementById('discountCodeDisplay').textContent = discountCode;
                document.getElementById('discountPercentageDisplay').textContent = `${discount.percentage}%`;
                document.getElementById('discountExpiryDisplay').textContent = expiryDate.toLocaleDateString('id-ID', {
                    day: '2-digit',
                    month: 'long',
                    year: 'numeric'
                });
                document.getElementById('discountMinPurchaseDisplay').textContent = discount.minPurchase ? `Rp ${formatRupiah(discount.minPurchase)}` : 'Tidak ada';
                document.getElementById('originalPriceDisplay').textContent = `Rp ${formatRupiah(originalPrice)}`;
                document.getElementById('discountAmountDisplay').textContent = `Rp ${formatRupiah(discountAmount)}`;
                document.getElementById('finalPriceDisplay').textContent = `Rp ${formatRupiah(discountedPrice)}`;
                
                // Update summary price
                document.getElementById('summaryPrice').textContent = `Rp ${formatRupiah(discountedPrice)} (Diskon ${discount.percentage}%)`;
                
                showToast(`âœ… Diskon ${discount.percentage}% berhasil diterapkan!`);
                
                // Send message to admin about discount usage
                const messageData = {
                    sender: 'system',
                    text: `ðŸŽ« **KODE DISKON DIGUNAKAN**\n\nUID: ${currentUID}\nKode: ${discountCode}\nDiskon: ${discount.percentage}%\nHarga Asli: Rp ${formatRupiah(originalPrice)}\nHarga Setelah Diskon: Rp ${formatRupiah(discountedPrice)}\nWaktu: ${new Date().toLocaleString('id-ID')}`,
                    timestamp: new Date().toISOString(),
                    type: 'system',
                    discountCode: discountCode
                };
                
                await database.ref('chats/' + currentUID).push(messageData);
                
            } catch (error) {
                console.error('Error applying discount:', error);
                showToast('âŒ Error: ' + error.message);
                resetDiscount();
            } finally {
                applyBtn.disabled = false;
                applyBtn.innerHTML = '<i class="fas fa-check"></i> TERAPKAN';
            }
        }
        
        function resetDiscount() {
            activeDiscount = null;
            discountedPrice = 0;
            originalPrice = 0;
            
            document.getElementById('discountInfo').classList.remove('active');
            document.getElementById('discountCode').value = '';
            
            if (selectedPrice > 0) {
                document.getElementById('summaryPrice').textContent = `Rp ${formatRupiah(selectedPrice)}`;
            }
        }
        
        function checkDiscountStatus() {
            if (activeDiscount) {
                // Re-validate discount periodically
                applyDiscountCode();
            }
        }
        
        // ==================== FUNGSI SALDO ====================
        
        function showDepositPopup() {
            resetDepositForm();
            document.getElementById('depositPopup').classList.add('active');
        }
        
        function closeDepositPopup() {
            document.getElementById('depositPopup').classList.remove('active');
        }
        
        function resetDepositForm() {
            document.getElementById('depositNama').value = '';
            document.getElementById('depositNoEwallet').value = '';
            document.getElementById('depositJumlah').value = '';
            document.getElementById('depositCatatan').value = '';
            document.getElementById('depositMetode').value = '';
            document.getElementById('depositNomorTujuan').value = '';
            
            document.querySelectorAll('.payment-method-item').forEach(el => {
                el.classList.remove('selected');
            });
            document.querySelectorAll('.amount-preset').forEach(el => {
                el.classList.remove('selected');
            });
            
            updateDepositSummary();
            
            selectedPaymentMethod = '';
            selectedPaymentNumber = '';
        }
        
        function selectPaymentMethod(method, number, element) {
            document.querySelectorAll('.payment-method-item').forEach(el => {
                el.classList.remove('selected');
            });
            
            if (element) {
                element.classList.add('selected');
            }
            
            selectedPaymentMethod = method;
            selectedPaymentNumber = number;
            document.getElementById('depositMetode').value = method;
            document.getElementById('depositNomorTujuan').value = number;
            
            updateDepositSummary();
            
            showToast(`Metode pembayaran: ${method}`);
        }
        
        function setDepositAmount(amount, element) {
            document.querySelectorAll('.amount-preset').forEach(el => {
                el.classList.remove('selected');
            });
            
            if (element) {
                element.classList.add('selected');
            }
            
            document.getElementById('depositJumlah').value = amount;
            
            validateDepositAmount();
            updateDepositSummary();
        }
        
        function validateDepositAmount() {
            const jumlahInput = document.getElementById('depositJumlah');
            let amount = parseInt(jumlahInput.value) || 0;
            
            if (amount < 20000 && amount > 0) {
                showToast('âš ï¸ Minimal deposit Rp 20.000');
                jumlahInput.style.borderColor = '#f44336';
            } else if (amount >= 20000) {
                jumlahInput.style.borderColor = '#4caf50';
            } else {
                jumlahInput.style.borderColor = 'rgba(255, 0, 0, 0.5)';
            }
            
            updateDepositSummary();
        }
        
        function updateDepositSummary() {
            const nama = document.getElementById('depositNama').value.trim() || '-';
            const noEwallet = document.getElementById('depositNoEwallet').value.trim() || '-';
            const metode = selectedPaymentMethod || '-';
            const tujuan = selectedPaymentNumber || '-';
            const jumlah = parseInt(document.getElementById('depositJumlah').value) || 0;
            const catatan = document.getElementById('depositCatatan').value.trim() || '-';
            
            document.getElementById('summaryNama').textContent = nama;
            document.getElementById('summaryNoEwallet').textContent = noEwallet;
            document.getElementById('summaryMetode').textContent = metode;
            document.getElementById('summaryTujuan').textContent = tujuan;
            document.getElementById('summaryJumlah').textContent = `Rp ${formatRupiah(jumlah)}`;
            document.getElementById('summaryCatatan').textContent = catatan;
        }
        
        function submitDeposit() {
            const submitBtn = document.getElementById('submitDepositBtn');
            
            const nama = document.getElementById('depositNama').value.trim();
            const noEwallet = document.getElementById('depositNoEwallet').value.trim();
            const metode = selectedPaymentMethod;
            const jumlah = parseInt(document.getElementById('depositJumlah').value) || 0;
            
            if (!nama) {
                showToast('âŒ Nama pengirim harus diisi!');
                document.getElementById('depositNama').focus();
                return;
            }
            
            if (!noEwallet) {
                showToast('âŒ No. E-Wallet pengirim harus diisi!');
                document.getElementById('depositNoEwallet').focus();
                return;
            }
            
            if (!metode) {
                showToast('âŒ Pilih metode pembayaran terlebih dahulu!');
                return;
            }
            
            if (jumlah < 20000) {
                showToast('âŒ Minimal deposit Rp 20.000!');
                document.getElementById('depositJumlah').focus();
                return;
            }
            
            if (!currentUID) {
                showToast('âŒ UID tidak ditemukan! Silakan login terlebih dahulu.');
                closeDepositPopup();
                showUidPopup();
                return;
            }
            
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> MENGIRIM...';
            
            const depositData = {
                uid: currentUID,
                namaPengirim: nama,
                noEwallet: noEwallet,
                metodePembayaran: metode,
                nomorTujuan: selectedPaymentNumber,
                jumlah: jumlah,
                catatan: document.getElementById('depositCatatan').value.trim() || '-',
                status: 'pending',
                timestamp: firebase.database.ServerValue.TIMESTAMP,
                waktu: new Date().toISOString()
            };
            
            database.ref('deposits/' + currentUID).push(depositData)
                .then((ref) => {
                    console.log('Deposit submitted successfully');
                    
                    const adminMessage = {
                        sender: 'system',
                        text: `ðŸ’° **DEPOSIT BARU**\n\nUID: ${currentUID}\nNama: ${nama}\nNo. E-Wallet: ${noEwallet}\nMetode: ${metode}\nNomor Tujuan: ${selectedPaymentNumber}\nJumlah: Rp ${formatRupiah(jumlah)}\nCatatan: ${depositData.catatan}\nStatus: PENDING\nWaktu: ${new Date().toLocaleString('id-ID')}`,
                        timestamp: new Date().toISOString(),
                        type: 'system',
                        depositId: ref.key
                    };
                    
                    return database.ref('chats/' + currentUID).push(adminMessage);
                })
                .then(() => {
                    showToast('âœ… Deposit berhasil dikirim! Admin akan memproses segera.');
                    closeDepositPopup();
                    resetDepositForm();
                })
                .catch((error) => {
                    console.error('Error submitting deposit:', error);
                    showToast('âŒ Gagal mengirim deposit: ' + error.message);
                })
                .finally(() => {
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = '<i class="fas fa-paper-plane"></i> KIRIM DEPOSIT';
                });
        }
        
        function monitorSaldo() {
            if (saldoListener) saldoListener();
            
            if (!currentUID) return;
            
            saldoListener = database.ref('saldo/' + currentUID).on('value', (snapshot) => {
                const saldoData = snapshot.val();
                if (saldoData) {
                    currentSaldo = saldoData.amount || 0;
                    updateSaldoDisplay();
                    document.getElementById('saldoContainer').style.display = 'block';
                } else {
                    currentSaldo = 0;
                    updateSaldoDisplay();
                    document.getElementById('saldoContainer').style.display = 'block';
                    
                    database.ref('saldo/' + currentUID).set({
                        amount: 0,
                        lastUpdate: firebase.database.ServerValue.TIMESTAMP,
                        created: new Date().toISOString()
                    });
                }
            });
        }
        
        function updateSaldoDisplay() {
            const saldoElement = document.getElementById('saldoAmount');
            if (currentSaldo >= 1000000) {
                saldoElement.innerHTML = `Rp ${formatRupiah(currentSaldo)} <span style="color: #00ff00; font-size: 14px;">(PREMIUM)</span>`;
            } else if (currentSaldo >= 500000) {
                saldoElement.innerHTML = `Rp ${formatRupiah(currentSaldo)} <span style="color: #ff9800; font-size: 14px;">(PRO)</span>`;
            } else {
                saldoElement.innerHTML = `Rp ${formatRupiah(currentSaldo)}`;
            }
        }
        
        function formatRupiah(amount) {
            if (amount >= 1000000) {
                return (amount / 1000000).toFixed(1).replace('.', ',') + ' JT';
            } else if (amount >= 1000) {
                return (amount / 1000).toFixed(0) + ' RB';
            }
            return amount.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
        }
        
        // ==================== FUNGSI VIP UPDATE DENGAN DUPLICATE CHECK ====================
        
        function setupVIPUpdateListener() {
            if (vipUpdateListener) vipUpdateListener();
            
            if (!currentUID) return;
            
            vipUpdateListener = database.ref('vip_updates').on('child_added', async (snapshot) => {
                const update = snapshot.val();
                const updateId = snapshot.key;
                
                if (!update || !update.active) return;
                
                try {
                    // ðŸ”´ CEK DUPLICATE UPDATE - JIKA SUDAH DIPROSES, SKIP
                    if (processedUpdates.has(updateId)) {
                        console.log(`â­ï¸ Update ${updateId} sudah pernah diproses, tidak akan mengurangi quota`);
                        return;
                    }
                    
                    // ðŸ”´ CEK APAKAH UPDATE INI SAMA DENGAN YANG TERAKHIR
                    const lastUpdateId = localStorage.getItem(`last_vip_update_${currentUID}`);
                    if (lastUpdateId === updateId) {
                        console.log(`â­ï¸ Update ${updateId} adalah update terakhir yang sama, tidak akan mengurangi quota`);
                        return;
                    }
                    
                    // ðŸ”´ CEK QUOTA UPDATE DENGAN KETAT
                    const canAccess = await checkUpdateQuota();
                    
                    if (!canAccess) {
                        console.log('â›” QUOTA UPDATE HABIS/MELEBIHI BATAS - POPUP TIDAK DITAMPILKAN');
                        return;
                    }
                    
                    const quotaSnapshot = await database.ref('updates/' + currentUID).once('value');
                    const quota = quotaSnapshot.val();
                    
                    if (!quota) {
                        console.log('âŒ Tidak memiliki quota update');
                        return;
                    }
                    
                    if (quota.total !== 'unlimited' && quota.remaining <= 0) {
                        console.log('âŒ Quota update habis - POPUP TIDAK DITAMPILKAN');
                        return;
                    }
                    
                    // âœ… TAMPILKAN POPUP (HANYA JIKA QUOTA MASIH ADA DAN UPDATE BARU)
                    console.log('âœ… Menampilkan popup update - Update baru dan quota masih tersedia');
                    showVIPUpdatePopup(update, updateId);
                    
                    // SIMPAN SEBAGAI SUDAH DIPROSES
                    processedUpdates.add(updateId);
                    saveProcessedUpdates();
                    
                    localStorage.setItem(`last_vip_update_${currentUID}`, updateId);
                    
                    // ðŸ”´ KURANGI QUOTA UPDATE HANYA JIKA INI UPDATE BARU
                    if (quota.total !== 'unlimited') {
                        const newUsed = (quota.used || 0) + 1;
                        const newRemaining = quota.total - newUsed;
                        
                        if (newRemaining >= 0) {
                            await database.ref('updates/' + currentUID).update({
                                used: newUsed,
                                remaining: newRemaining,
                                updated_at: new Date().toISOString(),
                                lastUpdateId: updateId
                            });
                            
                            console.log(`âœ… Quota update berkurang. Sisa: ${newRemaining}`);
                        }
                    } else {
                        const newUsed = (quota.used || 0) + 1;
                        
                        await database.ref('updates/' + currentUID).update({
                            used: newUsed,
                            remaining: 999999,
                            updated_at: new Date().toISOString(),
                            lastUpdateId: updateId
                        });
                        
                        console.log(`âœ… Unlimited update: ${newUsed}x digunakan`);
                    }
                    
                } catch (error) {
                    console.error('Error processing VIP update:', error);
                }
            });
        }
        
        async function checkUpdateQuota() {
            if (!currentUID) {
                console.log('âŒ UID tidak ditemukan');
                return false;
            }
            
            try {
                const snapshot = await database.ref('updates/' + currentUID).once('value');
                const quota = snapshot.val();
                
                if (!quota) {
                    console.log('âŒ User tidak memiliki quota update');
                    return false;
                }
                
                if (quota.total === 'unlimited') {
                    console.log('âœ… Unlimited update - bisa akses');
                    return true;
                }
                
                const total = parseInt(quota.total) || 0;
                const used = parseInt(quota.used) || 0;
                const remaining = parseInt(quota.remaining) || 0;
                
                if (total <= 0) {
                    console.log(`âŒ Total quota = 0, tidak bisa akses`);
                    return false;
                }
                
                if (used >= total) {
                    console.log(`âŒ Quota sudah habis! Used: ${used}, Total: ${total}`);
                    return false;
                }
                
                if (remaining <= 0) {
                    console.log(`âŒ Sisa quota = ${remaining}, tidak bisa akses`);
                    return false;
                }
                
                console.log(`âœ… Quota masih tersedia. Sisa: ${remaining}, Used: ${used}, Total: ${total}`);
                return true;
                
            } catch (error) {
                console.error('Error checking update quota:', error);
                return false;
            }
        }
        
        function showVIPUpdatePopup(update, updateId) {
            document.getElementById('vipUpdateTitle').textContent = update.title || 'VIP UPDATE';
            document.getElementById('vipUpdateVersion').textContent = update.version || 'v1.0.0';
            
            const updateTime = update.timestamp ? new Date(update.timestamp) : new Date();
            document.getElementById('vipUpdateTime').textContent = updateTime.toLocaleDateString('id-ID', {
                day: '2-digit',
                month: 'long',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            document.getElementById('vipUpdateDescription').textContent = update.description || 'Tidak ada deskripsi.';
            document.getElementById('vipUpdateLink').textContent = update.link || 'https://www.mediafire.com/folder/example';
            
            document.getElementById('vipUpdatePopup').classList.add('active');
            
            const adminMessage = {
                sender: 'system',
                text: `ðŸ“¢ *PEMBARUAN FILE TERSEDIA!*\n\n` +
                      `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n` +
                      `ðŸ“Œ ${update.title || 'Update File'}\n` +
                      `ðŸ“ ${update.description || ''}\n` +
                      `ðŸ”– Versi: ${update.version || 'v1.0.0'}\n` +
                      `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n` +
                      `ðŸ”— Download: ${update.link}`,
                timestamp: new Date().toISOString(),
                type: 'system'
            };
            
            database.ref('chats/' + currentUID).push(adminMessage);
        }
        
        function closeVipUpdatePopup() {
            document.getElementById('vipUpdatePopup').classList.remove('active');
        }
        
        function copyVipUpdateLink() {
            const link = document.getElementById('vipUpdateLink').textContent;
            copyToClipboard(link, 'Link MediaFire');
        }
        
        // ==================== FUNGSI VIP GLOBAL UPDATE DENGAN DUPLICATE CHECK ====================
        
        function monitorVIPGlobalUpdates() {
            database.ref('global_updates').on('child_added', async (snapshot) => {
                const update = snapshot.val();
                const updateId = snapshot.key;
                
                if (!currentUID) return;
                
                try {
                    // ðŸ”´ CEK DUPLICATE UPDATE GLOBAL
                    if (processedUpdates.has(updateId)) {
                        console.log(`â­ï¸ GLOBAL: Update ${updateId} sudah pernah diproses`);
                        return;
                    }
                    
                    const canAccess = await checkUpdateQuota();
                    
                    if (!canAccess) {
                        console.log('â›” GLOBAL: QUOTA UPDATE HABIS - POPUP TIDAK DITAMPILKAN');
                        return;
                    }
                    
                    const quotaSnapshot = await database.ref(`updates/${currentUID}`).once('value');
                    const quota = quotaSnapshot.val();
                    
                    if (quota) {
                        if (quota.total !== 'unlimited' && quota.remaining <= 0) {
                            console.log('âŒ GLOBAL: Quota habis - POPUP TIDAK DITAMPILKAN');
                            return;
                        }
                        
                        const seenUpdates = JSON.parse(localStorage.getItem(`vip_global_updates_${currentUID}`) || '[]');
                        
                        if (!seenUpdates.includes(updateId)) {
                            console.log('âœ… GLOBAL: Menampilkan popup update - Update baru dan quota masih tersedia');
                            showVIPGlobalUpdatePopup(update, updateId);
                            
                            seenUpdates.push(updateId);
                            localStorage.setItem(`vip_global_updates_${currentUID}`, JSON.stringify(seenUpdates));
                            
                            processedUpdates.add(updateId);
                            saveProcessedUpdates();
                            
                            await sendUpdateToVIP(currentUID, updateId, update);
                        }
                    }
                } catch (error) {
                    console.error('Error monitoring global update:', error);
                }
            });
            
            database.ref('global_updates').once('value')
                .then(async (snapshot) => {
                    const updates = snapshot.val();
                    if (updates && currentUID) {
                        const updateKeys = Object.keys(updates);
                        if (updateKeys.length > 0) {
                            const latestKey = updateKeys[updateKeys.length - 1];
                            const latestUpdate = updates[latestKey];
                            
                            if (processedUpdates.has(latestKey)) {
                                console.log(`â­ï¸ LOGIN: Update ${latestKey} sudah pernah diproses`);
                                return;
                            }
                            
                            const canAccess = await checkUpdateQuota();
                            
                            if (!canAccess) {
                                console.log('â›” LOGIN: QUOTA UPDATE HABIS - POPUP TIDAK DITAMPILKAN');
                                return;
                            }
                            
                            const quotaSnapshot = await database.ref(`updates/${currentUID}`).once('value');
                            const quota = quotaSnapshot.val();
                            
                            if (quota) {
                                if (quota.total !== 'unlimited' && quota.remaining <= 0) {
                                    console.log('âŒ LOGIN: Quota habis - POPUP TIDAK DITAMPILKAN');
                                    return;
                                }
                                
                                const seenUpdates = JSON.parse(localStorage.getItem(`vip_global_updates_${currentUID}`) || '[]');
                                
                                if (!seenUpdates.includes(latestKey)) {
                                    showVIPGlobalUpdatePopup(latestUpdate, latestKey);
                                    
                                    seenUpdates.push(latestKey);
                                    localStorage.setItem(`vip_global_updates_${currentUID}`, JSON.stringify(seenUpdates));
                                    
                                    processedUpdates.add(latestKey);
                                    saveProcessedUpdates();
                                    
                                    await sendUpdateToVIP(currentUID, latestKey, latestUpdate);
                                }
                            }
                        }
                    }
                });
        }
        
        function showVIPGlobalUpdatePopup(update, updateId) {
            const popup = document.getElementById('vipGlobalUpdatePopup');
            
            document.getElementById('vipGlobalUpdateTitle').textContent = update.title || 'VIP UPDATE TERSEDIA!';
            document.getElementById('vipGlobalUpdateVersion').textContent = update.version || 'v2.5.0';
            
            const updateDate = update.timestamp ? new Date(update.timestamp) : new Date();
            document.getElementById('vipGlobalUpdateDate').textContent = 
                updateDate.toLocaleDateString('id-ID', {
                    weekday: 'long',
                    day: '2-digit',
                    month: 'long',
                    year: 'numeric'
                });
            document.getElementById('vipGlobalUpdateTime').textContent = 
                updateDate.toLocaleTimeString('id-ID', {
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
            
            document.getElementById('vipGlobalUpdateSize').textContent = update.size || '~15 MB';
            document.getElementById('vipGlobalUpdateDescription').textContent = 
                update.description || 'Tidak ada deskripsi detail untuk pembaruan ini.';
            document.getElementById('vipGlobalUpdateLink').textContent = 
                update.link || 'https://www.mediafire.com/folder/example';
            
            popup.classList.add('active');
            
            setTimeout(() => {
                if (popup.classList.contains('active')) {
                    closeVipGlobalUpdatePopup();
                }
            }, 30000);
        }
        
        function closeVipGlobalUpdatePopup() {
            document.getElementById('vipGlobalUpdatePopup').classList.remove('active');
        }
        
        function copyVipGlobalUpdateLink() {
            const link = document.getElementById('vipGlobalUpdateLink').textContent;
            copyToClipboard(link, 'Link Download');
        }
        
        async function sendUpdateToVIP(uid, updateId, updateData) {
            try {
                const snapshot = await database.ref(`updates/${uid}`).once('value');
                const quota = snapshot.val();
                
                if (!quota) {
                    console.log('User tidak memiliki quota update');
                    return;
                }
                
                if (quota.total !== 'unlimited' && quota.remaining <= 0) {
                    console.log('Quota update sudah habis, tidak mengirim pesan');
                    return;
                }
                
                const messageData = {
                    sender: 'system',
                    text: `ðŸ“¢ *PEMBARUAN FILE VIP TERSEDIA!*\n\n` +
                          `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n` +
                          `ðŸ“Œ **${updateData.title || 'Update File'}**\n` +
                          `ðŸ“ Deskripsi: ${updateData.description || 'Pembaruan file VIP terbaru'}\n` +
                          `ðŸ”– Versi: ${updateData.version || 'v1.0'}\n` +
                          `ðŸ“¦ Size: ${updateData.size || '~15 MB'}\n` +
                          `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n` +
                          `ðŸ”— Link Download: ${updateData.link}\n\n` +
                          `ðŸ’¡ Klik link di atas untuk mendownload file terbaru.`,
                    timestamp: new Date().toISOString(),
                    type: 'system',
                    updateId: updateId
                };
                
                await database.ref(`chats/${uid}`).push(messageData);
                
                if (quota.total !== 'unlimited') {
                    const newUsed = (quota.used || 0) + 1;
                    const newRemaining = quota.total - newUsed;
                    
                    if (newRemaining >= 0) {
                        await database.ref(`updates/${uid}`).update({
                            used: newUsed,
                            remaining: newRemaining,
                            lastUpdate: new Date().toISOString(),
                            lastUpdateId: updateId
                        });
                        console.log(`âœ… Quota update berkurang. Sisa: ${newRemaining}`);
                    }
                } else {
                    const newUsed = (quota.used || 0) + 1;
                    
                    await database.ref(`updates/${uid}`).update({
                        used: newUsed,
                        remaining: 999999,
                        lastUpdate: new Date().toISOString(),
                        lastUpdateId: updateId
                    });
                }
                
                console.log(`âœ… Update berhasil dikirim ke ${uid}`);
                
            } catch (error) {
                console.error('Error sending update:', error);
            }
        }
        
        // ==================== FUNGSI UPDATE SYSTEM ====================
        
        function monitorUpdates() {
            if (updateListener) updateListener();
            
            if (!currentUID) return;
            
            updateListener = database.ref('updates/' + currentUID).on('value', (snapshot) => {
                const updateData = snapshot.val();
                if (updateData) {
                    updateUpdateCounter(updateData);
                } else {
                    hideUpdateCounter();
                }
            });
        }
        
        function updateUpdateCounter(updateData) {
            const used = updateData.used || 0;
            let total = updateData.total || 0;
            let remaining = updateData.remaining || 0;
            const packageName = updateData.package || 'VIP Package';
            
            document.getElementById('updateCounter').style.display = 'block';
            
            if (total === 'unlimited') {
                document.getElementById('updateCounterDisplay').textContent = `${used} / âˆž`;
                document.getElementById('updateCounterInfo').textContent = 
                    `Anda memiliki pembaruan unlimited | ${used} kali digunakan`;
                document.getElementById('updateProgressBar').style.width = '100%';
            } else {
                document.getElementById('updateCounterDisplay').textContent = `${used} / ${total}`;
                
                const progress = total > 0 ? (used / total) * 100 : 0;
                document.getElementById('updateProgressBar').style.width = `${progress}%`;
                
                remaining = total - used;
                if (remaining <= 0) {
                    document.getElementById('updateCounterInfo').textContent = 
                        `Pembaruan sudah habis! Beli VIP lagi untuk update baru`;
                    document.getElementById('updateCounterInfo').style.color = '#f44336';
                } else {
                    document.getElementById('updateCounterInfo').textContent = 
                        `Anda memiliki ${remaining} pembaruan tersisa dari total ${total} pembaruan`;
                    document.getElementById('updateCounterInfo').style.color = '#ff6b6b';
                }
            }
            
            if (updateData.price && !document.getElementById('summaryPackage').textContent.includes('-')) {
                updateOrderSummary(packageName, updateData.price, total, updateData.purchaseTime);
            }
        }
        
        function hideUpdateCounter() {
            document.getElementById('updateCounter').style.display = 'none';
        }
        
        // ==================== FUNGSI PURCHASE HISTORY ====================
        
        function monitorPurchaseHistory() {
            if (purchaseListener) purchaseListener();
            
            if (!currentUID) return;
            
            purchaseListener = database.ref('purchases/' + currentUID).on('value', (snapshot) => {
                const purchases = snapshot.val();
                const historyList = document.getElementById('historyList');
                
                if (purchases) {
                    document.getElementById('purchaseHistory').style.display = 'block';
                    
                    const purchasesArray = Object.keys(purchases).map(key => {
                        return {
                            id: key,
                            ...purchases[key]
                        };
                    }).sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                    
                    if (purchasesArray.length > 0) {
                        historyList.innerHTML = '';
                        
                        purchasesArray.forEach(purchase => {
                            const historyItem = document.createElement('div');
                            historyItem.className = 'history-item';
                            
                            const date = new Date(purchase.timestamp);
                            const formattedDate = date.toLocaleDateString('id-ID', {
                                weekday: 'long',
                                day: '2-digit',
                                month: 'long',
                                year: 'numeric',
                                hour: '2-digit',
                                minute: '2-digit'
                            });
                            
                            const updatesText = purchase.updates === 'unlimited' ? 'âˆž' : purchase.updates;
                            
                            historyItem.innerHTML = `
                                <div class="history-package">${purchase.packageName || 'VIP Package'}</div>
                                <div class="history-details">
                                    <span><i class="fas fa-tag"></i> Rp ${formatRupiah(purchase.price)}</span>
                                    <span><i class="fas fa-sync-alt"></i> ${updatesText} Update</span>
                                    <span><i class="fas fa-clock"></i> ${formattedDate}</span>
                                </div>
                            `;
                            historyList.appendChild(historyItem);
                        });
                    } else {
                        historyList.innerHTML = '<div class="no-data">Belum ada riwayat pembelian</div>';
                    }
                } else {
                    document.getElementById('purchaseHistory').style.display = 'block';
                    historyList.innerHTML = '<div class="no-data">Belum ada riwayat pembelian</div>';
                }
            });
        }
        
        // ==================== FUNGSI ADMIN STATUS ====================
        
        function monitorAdminStatus() {
            database.ref('admin_status').on('value', (snapshot) => {
                const statusData = snapshot.val();
                if (statusData && statusData.status === 'online') {
                    const lastSeen = statusData.last_seen;
                    const now = Date.now();
                    const fiveMinutesAgo = now - (5 * 60 * 1000);
                    
                    if (lastSeen > fiveMinutesAgo) {
                        adminOnline = true;
                        document.getElementById('statusIndicator').className = 'status-indicator status-online';
                        document.getElementById('statusText').textContent = translations[currentLanguage]?.admin_online || 'Admin: Online';
                        document.getElementById('adminStatus').style.display = 'flex';
                    } else {
                        adminOnline = false;
                        document.getElementById('statusIndicator').className = 'status-indicator status-offline';
                        document.getElementById('statusText').textContent = translations[currentLanguage]?.admin_offline || 'Admin: Offline';
                        document.getElementById('adminStatus').style.display = 'flex';
                    }
                } else {
                    adminOnline = false;
                    document.getElementById('statusIndicator').className = 'status-indicator status-offline';
                    document.getElementById('statusText').textContent = translations[currentLanguage]?.admin_offline || 'Admin: Offline';
                    document.getElementById('adminStatus').style.display = 'flex';
                }
            });
        }
        
        // ==================== FUNGSI UID ====================
        
        function loadExistingUid() {
            const uidInput = document.getElementById('existingUidInput').value.trim();
            
            if (!uidInput) {
                showError('existingUidError', 'Silakan masukkan UID Anda');
                return;
            }
            
            if (!uidInput.startsWith('VIP_')) {
                showError('existingUidError', 'Format UID tidak valid. UID harus dimulai dengan "VIP_"');
                return;
            }
            
            if (uidInput.length < 10) {
                showError('existingUidError', 'UID terlalu pendek');
                return;
            }
            
            showSuccess('existingUidSuccess', 'Memeriksa UID...');
            hideError('existingUidError');
            
            database.ref('customers/' + uidInput).once('value')
                .then((snapshot) => {
                    if (snapshot.exists()) {
                        currentUID = uidInput;
                        showSuccess('existingUidSuccess', 'UID ditemukan! Memuat data...');
                        saveUidToLocalStorage(uidInput);
                        loadProcessedUpdates();
                        
                        setTimeout(() => {
                            startSession(currentUID);
                        }, 1000);
                    } else {
                        const customerData = {
                            uid: uidInput,
                            createdAt: firebase.database.ServerValue.TIMESTAMP,
                            firstLogin: new Date().toISOString(),
                            loginCount: 1,
                            lastActive: firebase.database.ServerValue.TIMESTAMP,
                            userAgent: navigator.userAgent,
                            platform: navigator.platform,
                            language: currentLanguage
                        };
                        
                        database.ref('customers/' + uidInput).set(customerData)
                            .then(() => {
                                currentUID = uidInput;
                                showSuccess('existingUidSuccess', 'UID baru dibuat! Memuat data...');
                                saveUidToLocalStorage(uidInput);
                                loadProcessedUpdates();
                                
                                setTimeout(() => {
                                    startSession(currentUID);
                                }, 1000);
                            })
                            .catch((error) => {
                                console.error('Error creating customer:', error);
                                showError('existingUidError', 'Gagal membuat UID baru');
                                hideSuccess('existingUidSuccess');
                            });
                    }
                })
                .catch((error) => {
                    console.error('Error checking customer:', error);
                    showError('existingUidError', 'Terjadi kesalahan saat memeriksa UID');
                    hideSuccess('existingUidSuccess');
                });
        }
        
        function saveUidToLocalStorage(uid) {
            localStorage.setItem('vip_files_uid', uid);
            localStorage.setItem('vip_files_timestamp', Date.now().toString());
        }
        
        function checkSavedUid() {
            const savedUid = localStorage.getItem('vip_files_uid');
            const savedTimestamp = localStorage.getItem('vip_files_timestamp');
            
            if (savedUid && savedTimestamp) {
                const thirtyDaysAgo = Date.now() - (30 * 24 * 60 * 60 * 1000);
                if (parseInt(savedTimestamp) > thirtyDaysAgo) {
                    document.getElementById('existingUidInput').value = savedUid;
                }
            }
        }
        
        // ==================== FUNGSI SESSION ====================
        
        function startSession(uid) {
            currentUID = uid;
            
            document.getElementById('uidPopup').classList.remove('active');
            document.getElementById('mainContainer').style.display = 'flex';
            document.getElementById('saldoContainer').style.display = 'block';
            document.getElementById('adminStatus').style.display = 'flex';
            document.getElementById('fileGallery').classList.add('active');
            document.getElementById('transactionGallery').classList.add('active');
            
            document.getElementById('uidValue').textContent = currentUID;
            
            document.getElementById('chatInput').disabled = false;
            document.getElementById('chatSendBtn').disabled = false;
            
            setupChatListener();
            monitorSaldo();
            monitorUpdates();
            monitorPurchaseHistory();
            
            setupVIPUpdateListener();
            monitorVIPGlobalUpdates();
            
            setupFileGalleryListener();
            setupTransactionGalleryListener();
            
            updateCustomerData();
            
            loadExistingUpdates();
            loadPurchaseHistory();
            
            showToast(`âœ… Selamat datang! UID Anda: ${currentUID}`);
        }
        
        function showUidPopup() {
            document.getElementById('uidPopup').classList.add('active');
            document.getElementById('mainContainer').style.display = 'none';
            document.getElementById('saldoContainer').style.display = 'none';
            document.getElementById('adminStatus').style.display = 'none';
            document.getElementById('fileGallery').classList.remove('active');
            document.getElementById('transactionGallery').classList.remove('active');
            
            cleanupListeners();
            
            currentUID = '';
            showToast('Silakan masukkan UID Anda');
        }
        
        // ==================== FUNGSI FIREBASE ====================
        
        function updateCustomerData() {
            const customerData = {
                uid: currentUID,
                lastActive: firebase.database.ServerValue.TIMESTAMP,
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                language: currentLanguage,
                ip: 'detected'
            };
            
            database.ref('customers/' + currentUID).once('value')
                .then((snapshot) => {
                    if (snapshot.exists()) {
                        database.ref('customers/' + currentUID).update({
                            lastActive: firebase.database.ServerValue.TIMESTAMP,
                            lastLogin: new Date().toISOString(),
                            loginCount: firebase.database.ServerValue.increment(1),
                            language: currentLanguage
                        });
                        
                        const customer = snapshot.val();
                        if (customer.createdAt) {
                            const createdDate = new Date(customer.createdAt);
                            document.getElementById('uidCreated').textContent = createdDate.toLocaleDateString('id-ID', {
                                day: '2-digit',
                                month: 'short',
                                year: 'numeric',
                                hour: '2-digit',
                                minute: '2-digit'
                            });
                        }
                    } else {
                        customerData.createdAt = firebase.database.ServerValue.TIMESTAMP;
                        customerData.firstLogin = new Date().toISOString();
                        customerData.loginCount = 1;
                        
                        database.ref('customers/' + currentUID).set(customerData);
                        document.getElementById('uidCreated').textContent = 'Baru saja';
                    }
                })
                .catch((error) => {
                    console.error('Error updating customer data:', error);
                });
        }
        
        function loadExistingUpdates() {
            database.ref('updates/' + currentUID).once('value')
                .then((snapshot) => {
                    if (snapshot.exists()) {
                        const updateData = snapshot.val();
                        updateUpdateCounter(updateData);
                    }
                });
        }
        
        function loadPurchaseHistory() {
            database.ref('purchases/' + currentUID).once('value')
                .then((snapshot) => {
                    if (snapshot.exists()) {
                        const purchases = snapshot.val();
                        const latestPurchase = Object.values(purchases).sort((a, b) => 
                            new Date(b.timestamp) - new Date(a.timestamp)
                        )[0];
                        
                        if (latestPurchase) {
                            updateOrderSummary(
                                latestPurchase.packageName,
                                latestPurchase.price,
                                latestPurchase.updates,
                                latestPurchase.timestamp
                            );
                        }
                    }
                });
        }
        
        // ==================== FUNGSI CHAT - ENHANCED ====================
        
        function setupChatListener() {
            if (chatListener) chatListener();
            
            document.getElementById('chatMessages').innerHTML = '<div class="no-data">Memuat riwayat chat...</div>';
            
            chatListener = database.ref('chats/' + currentUID).on('value', (snapshot) => {
                const messages = snapshot.val();
                const chatMessages = document.getElementById('chatMessages');
                
                if (messages) {
                    const messagesArray = Object.keys(messages).map(key => {
                        return {
                            id: key,
                            ...messages[key]
                        };
                    }).sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));
                    
                    chatMessages.innerHTML = '';
                    
                    if (messagesArray.length > 0) {
                        messagesArray.forEach(message => {
                            displayMessage(message.sender, message.text, message.timestamp, message.type, message.fileData);
                        });
                        
                        document.getElementById('chatStatus').innerHTML = 
                            `<i class="fas fa-circle" style="color: #4caf50;"></i> 
                            ${translations[currentLanguage]?.terhubung || 'TERHUBUNG'} (${messagesArray.length} pesan)`;
                    } else {
                        chatMessages.innerHTML = '<div class="no-data">Belum ada pesan. Mulai percakapan dengan admin!</div>';
                    }
                } else {
                    chatMessages.innerHTML = '<div class="no-data">Belum ada pesan. Mulai percakapan dengan admin!</div>';
                    document.getElementById('chatStatus').innerHTML = 
                        `<i class="fas fa-circle" style="color: #4caf50;"></i> 
                        ${translations[currentLanguage]?.terhubung || 'TERHUBUNG'} (0 pesan)`;
                }
                
                setTimeout(() => {
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }, 100);
            });
        }
        
        function displayMessage(sender, text, timestamp, type = 'normal', fileData = null) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            
            if (type === 'system') {
                messageDiv.className = 'message system-message';
            } else {
                messageDiv.className = `message ${sender === 'customer' ? 'customer-message' : 'admin-message'}`;
            }
            
            if (type !== 'system') {
                const senderText = document.createElement('div');
                senderText.className = 'message-sender';
                senderText.textContent = sender === 'customer' ? 'ANDA' : 'ADMIN';
                messageDiv.appendChild(senderText);
            }
            
            if (text) {
                const textDiv = document.createElement('div');
                textDiv.className = 'message-text';
                textDiv.textContent = text;
                messageDiv.appendChild(textDiv);
            }
            
            if (fileData) {
                const fileDiv = document.createElement('div');
                fileDiv.className = 'file-message';
                
                if (fileData.type && fileData.type.startsWith('image/')) {
                    const img = document.createElement('img');
                    img.src = fileData.url;
                    img.className = 'image-message';
                    img.onclick = () => window.open(fileData.url, '_blank');
                    fileDiv.appendChild(img);
                    
                    // Tambahkan ke gallery foto
                    if (currentUID) {
                        addToPhotoGallery(fileData, timestamp);
                    }
                } else {
                    fileDiv.innerHTML = `
                        <div class="file-info">
                            <i class="fas ${getFileIcon(fileData.name)} file-icon"></i>
                            <div class="file-details">
                                <div class="file-name">${fileData.name}</div>
                                <div class="file-size">${formatFileSize(fileData.size)}</div>
                            </div>
                            <button class="file-download-btn" onclick="window.open('${fileData.url}', '_blank')">
                                <i class="fas fa-download"></i> DOWNLOAD
                            </button>
                        </div>
                    `;
                    
                    // Tambahkan ke gallery file
                    if (currentUID) {
                        addToFileGallery(fileData, timestamp);
                    }
                }
                
                messageDiv.appendChild(fileDiv);
            }
            
            const timeDiv = document.createElement('div');
            timeDiv.className = 'message-time';
            const date = new Date(timestamp);
            timeDiv.textContent = date.toLocaleTimeString('id-ID', { 
                hour: '2-digit', 
                minute: '2-digit',
                hour12: false 
            }) + ' | ' + date.toLocaleDateString('id-ID');
            messageDiv.appendChild(timeDiv);
            
            chatMessages.appendChild(messageDiv);
        }
        
        function getFileIcon(filename) {
            const ext = filename.split('.').pop().toLowerCase();
            const icons = {
                'pdf': 'fa-file-pdf',
                'doc': 'fa-file-word',
                'docx': 'fa-file-word',
                'xls': 'fa-file-excel',
                'xlsx': 'fa-file-excel',
                'zip': 'fa-file-archive',
                'rar': 'fa-file-archive',
                '7z': 'fa-file-archive',
                'mp4': 'fa-file-video',
                'mp3': 'fa-file-audio',
                'jpg': 'fa-file-image',
                'jpeg': 'fa-file-image',
                'png': 'fa-file-image',
                'gif': 'fa-file-image'
            };
            return icons[ext] || 'fa-file';
        }
        
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        function sendMessage() {
            const chatInput = document.getElementById('chatInput');
            const message = chatInput.value.trim();
            
            if (!message) {
                showToast('Pesan harus diisi');
                return;
            }
            
            if (!currentUID) {
                showToast('UID tidak ditemukan, silakan refresh halaman');
                return;
            }
            
            const messageData = {
                sender: 'customer',
                text: message,
                timestamp: new Date().toISOString(),
                type: 'normal',
                uid: currentUID,
                read: false
            };
            
            database.ref('chats/' + currentUID).push(messageData)
                .then(() => {
                    console.log('Message sent successfully');
                    chatInput.value = '';
                    chatInput.focus();
                    
                    database.ref('customers/' + currentUID).update({
                        lastActive: firebase.database.ServerValue.TIMESTAMP,
                        lastMessage: new Date().toISOString()
                    });
                })
                .catch((error) => {
                    console.error('Error sending message:', error);
                    showToast('Gagal mengirim pesan: ' + error.message);
                });
        }
        
        function handleChatEnter(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }
        
        // ==================== FUNGSI UPLOAD FILE - ENHANCED ====================
        
        function uploadFile() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];
            
            if (!file) return;
            
            if (file.size > 100 * 1024 * 1024) {
                showToast('âŒ Ukuran file maksimal 100 MB');
                fileInput.value = '';
                return;
            }
            
            const uploadProgress = document.getElementById('uploadProgress');
            const progressBar = document.getElementById('uploadProgressBar');
            uploadProgress.style.display = 'block';
            progressBar.style.width = '0%';
            
            const fileName = `${Date.now()}_${file.name}`;
            const filePath = `chats/${currentUID}/${fileName}`;
            const storageRef = storage.ref(filePath);
            const uploadTask = storageRef.put(file);
            
            uploadTask.on('state_changed',
                (snapshot) => {
                    const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                    progressBar.style.width = progress + '%';
                },
                (error) => {
                    console.error('Upload error:', error);
                    showToast('âŒ Gagal mengupload file');
                    uploadProgress.style.display = 'none';
                    fileInput.value = '';
                },
                () => {
                    uploadTask.snapshot.ref.getDownloadURL().then((downloadURL) => {
                        const fileData = {
                            name: file.name,
                            size: file.size,
                            url: downloadURL,
                            type: file.type,
                            path: filePath,
                            timestamp: new Date().toISOString()
                        };
                        
                        const messageData = {
                            sender: 'customer',
                            timestamp: new Date().toISOString(),
                            type: 'normal',
                            uid: currentUID,
                            read: false,
                            fileData: fileData
                        };
                        
                        database.ref('chats/' + currentUID).push(messageData)
                            .then(() => {
                                showToast('âœ… File berhasil dikirim');
                                uploadProgress.style.display = 'none';
                                fileInput.value = '';
                                
                                if (file.type.startsWith('image/')) {
                                    addToPhotoGallery(fileData, new Date().toISOString());
                                } else {
                                    addToFileGallery(fileData, new Date().toISOString());
                                }
                            })
                            .catch((error) => {
                                console.error('Error sending file message:', error);
                                showToast('âŒ Gagal mengirim file');
                                uploadProgress.style.display = 'none';
                                fileInput.value = '';
                            });
                    });
                }
            );
        }
        
        // ==================== FUNGSI FILE GALLERY ====================
        
        function setupFileGalleryListener() {
            if (!currentUID) return;
            
            database.ref('chats/' + currentUID).on('value', (snapshot) => {
                const messages = snapshot.val();
                if (messages) {
                    allFiles = [];
                    allPhotos = [];
                    
                    Object.values(messages).forEach(message => {
                        if (message.fileData) {
                            if (message.fileData.type && message.fileData.type.startsWith('image/')) {
                                allPhotos.push({
                                    ...message.fileData,
                                    timestamp: message.timestamp,
                                    sender: message.sender
                                });
                            } else {
                                allFiles.push({
                                    ...message.fileData,
                                    timestamp: message.timestamp,
                                    sender: message.sender
                                });
                            }
                        }
                    });
                    
                    // Sort by timestamp descending (newest first)
                    allFiles.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                    allPhotos.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                    
                    updateGalleryDisplay();
                }
            });
        }
        
        function setupTransactionGalleryListener() {
            if (!currentUID) return;
            
            database.ref('deposits/' + currentUID).on('value', (snapshot) => {
                const deposits = snapshot.val();
                if (deposits) {
                    allTransactions = Object.keys(deposits).map(key => {
                        return {
                            id: key,
                            ...deposits[key]
                        };
                    }).sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                    
                    updateTransactionGallery();
                }
            });
            
            database.ref('purchases/' + currentUID).on('value', (snapshot) => {
                const purchases = snapshot.val();
                if (purchases) {
                    const purchaseArray = Object.keys(purchases).map(key => {
                        return {
                            id: key,
                            ...purchases[key],
                            type: 'purchase'
                        };
                    });
                    
                    allTransactions = [...allTransactions, ...purchaseArray].sort((a, b) => 
                        new Date(b.timestamp) - new Date(a.timestamp)
                    );
                    
                    updateTransactionGallery();
                }
            });
        }
        
        function addToFileGallery(fileData, timestamp) {
            allFiles.unshift({
                ...fileData,
                timestamp: timestamp
            });
            updateGalleryDisplay();
        }
        
        function addToPhotoGallery(fileData, timestamp) {
            allPhotos.unshift({
                ...fileData,
                timestamp: timestamp
            });
            updateGalleryDisplay();
        }
        
        function addToTransactionGallery(transactionData) {
            allTransactions.unshift(transactionData);
            updateTransactionGallery();
        }
        
        function switchGalleryTab(tab) {
            document.querySelectorAll('.gallery-tab').forEach(el => {
                el.classList.remove('active');
            });
            event.target.classList.add('active');
            
            document.getElementById('galleryFiles').style.display = 'none';
            document.getElementById('galleryTransactions').style.display = 'none';
            document.getElementById('galleryPhotos').style.display = 'none';
            
            if (tab === 'files') {
                document.getElementById('galleryFiles').style.display = 'grid';
                updateGalleryFiles();
            } else if (tab === 'transactions') {
                document.getElementById('galleryTransactions').style.display = 'grid';
                updateGalleryTransactions();
            } else if (tab === 'photos') {
                document.getElementById('galleryPhotos').style.display = 'grid';
                updateGalleryPhotos();
            }
        }
        
        function updateGalleryDisplay() {
            updateGalleryFiles();
            updateGalleryPhotos();
        }
        
        function updateGalleryFiles() {
            const container = document.getElementById('galleryFiles');
            
            if (allFiles.length === 0) {
                container.innerHTML = '<div class="no-data">Belum ada file</div>';
                return;
            }
            
            container.innerHTML = '';
            
            allFiles.slice(0, 20).forEach(file => {
                const date = new Date(file.timestamp);
                const formattedDate = date.toLocaleDateString('id-ID', {
                    day: '2-digit',
                    month: 'short',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                const item = document.createElement('div');
                item.className = 'gallery-item';
                item.innerHTML = `
                    <div class="gallery-file">
                        <i class="fas ${getFileIcon(file.name)} gallery-file-icon"></i>
                        <div class="gallery-file-info">
                            <div class="gallery-file-name">${file.name}</div>
                            <div class="gallery-file-size">${formatFileSize(file.size)}</div>
                            <div class="gallery-file-date">${formattedDate}</div>
                        </div>
                    </div>
                    <button class="gallery-download-btn" onclick="window.open('${file.url}', '_blank')">
                        <i class="fas fa-download"></i> DOWNLOAD
                    </button>
                `;
                container.appendChild(item);
            });
        }
        
        function updateGalleryPhotos() {
            const container = document.getElementById('galleryPhotos');
            
            if (allPhotos.length === 0) {
                container.innerHTML = '<div class="no-data">Belum ada foto</div>';
                return;
            }
            
            container.innerHTML = '';
            
            allPhotos.slice(0, 20).forEach(photo => {
                const date = new Date(photo.timestamp);
                const formattedDate = date.toLocaleDateString('id-ID', {
                    day: '2-digit',
                    month: 'short',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                const item = document.createElement('div');
                item.className = 'gallery-item';
                item.innerHTML = `
                    <img src="${photo.url}" class="gallery-image" onclick="window.open('${photo.url}', '_blank')">
                    <div class="gallery-file-info">
                        <div class="gallery-file-name">${photo.name}</div>
                        <div class="gallery-file-size">${formatFileSize(photo.size)}</div>
                        <div class="gallery-file-date">${formattedDate}</div>
                    </div>
                    <button class="gallery-download-btn" onclick="window.open('${photo.url}', '_blank')">
                        <i class="fas fa-download"></i> DOWNLOAD
                    </button>
                `;
                container.appendChild(item);
            });
        }
        
        function updateGalleryTransactions() {
            const container = document.getElementById('galleryTransactions');
            
            if (allTransactions.length === 0) {
                container.innerHTML = '<div class="no-data">Belum ada transaksi</div>';
                return;
            }
            
            container.innerHTML = '';
            
            allTransactions.slice(0, 20).forEach(transaction => {
                const date = new Date(transaction.timestamp);
                const formattedDate = date.toLocaleDateString('id-ID', {
                    day: '2-digit',
                    month: 'long',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                const item = document.createElement('div');
                item.className = 'gallery-item';
                
                if (transaction.type === 'purchase') {
                    item.innerHTML = `
                        <div class="gallery-file">
                            <i class="fas fa-shopping-cart gallery-file-icon" style="color: #2196f3;"></i>
                            <div class="gallery-file-info">
                                <div class="gallery-file-name">${transaction.packageName || 'VIP Package'}</div>
                                <div class="gallery-file-size">Rp ${formatRupiah(transaction.price)}</div>
                                <div class="gallery-file-date">${formattedDate}</div>
                                <div style="color: #4caf50; margin-top: 5px;">Status: SUCCESS</div>
                            </div>
                        </div>
                    `;
                } else {
                    const statusClass = transaction.status === 'pending' ? 'status-pending' : 
                                      transaction.status === 'success' ? 'status-success' : 'status-failed';
                    const statusText = transaction.status === 'pending' ? 'PENDING' : 
                                      transaction.status === 'success' ? 'SUCCESS' : 'FAILED';
                    
                    item.innerHTML = `
                        <div class="gallery-file">
                            <i class="fas fa-credit-card gallery-file-icon" style="color: #ff9800;"></i>
                            <div class="gallery-file-info">
                                <div class="gallery-file-name">Deposit - ${transaction.metodePembayaran}</div>
                                <div class="gallery-file-size">Rp ${formatRupiah(transaction.jumlah)}</div>
                                <div class="gallery-file-date">${formattedDate}</div>
                                <div style="color: ${transaction.status === 'pending' ? '#ff9800' : transaction.status === 'success' ? '#4caf50' : '#f44336'}; margin-top: 5px;">
                                    Status: ${statusText}
                                </div>
                            </div>
                        </div>
                    `;
                }
                
                container.appendChild(item);
            });
        }
        
        function updateTransactionGallery() {
            const container = document.getElementById('transactionContent');
            
            if (allTransactions.length === 0) {
                container.innerHTML = '<div class="no-data">Belum ada transaksi</div>';
                return;
            }
            
            container.innerHTML = '';
            
            allTransactions.slice(0, 10).forEach(transaction => {
                const date = new Date(transaction.timestamp);
                const formattedDate = date.toLocaleDateString('id-ID', {
                    day: '2-digit',
                    month: 'long',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                const item = document.createElement('div');
                item.className = 'transaction-item';
                
                if (transaction.type === 'purchase') {
                    item.innerHTML = `
                        <div class="transaction-header">
                            <div class="transaction-icon"><i class="fas fa-shopping-cart"></i></div>
                            <div class="transaction-info">
                                <div class="transaction-id">Pembelian VIP</div>
                                <div class="transaction-date">${formattedDate}</div>
                            </div>
                        </div>
                        <div class="transaction-details">
                            <div><strong>Paket:</strong> ${transaction.packageName || 'VIP Package'}</div>
                            <div><strong>Harga:</strong> Rp ${formatRupiah(transaction.price)}</div>
                            <div><strong>Update:</strong> ${transaction.updates === 'unlimited' ? 'Unlimited' : transaction.updates + 'x'}</div>
                        </div>
                        <div class="transaction-status status-success">SUCCESS</div>
                    `;
                } else {
                    const statusClass = transaction.status === 'pending' ? 'status-pending' : 
                                      transaction.status === 'success' ? 'status-success' : 'status-failed';
                    const statusText = transaction.status === 'pending' ? 'PENDING' : 
                                      transaction.status === 'success' ? 'SUCCESS' : 'FAILED';
                    
                    item.innerHTML = `
                        <div class="transaction-header">
                            <div class="transaction-icon"><i class="fas fa-credit-card"></i></div>
                            <div class="transaction-info">
                                <div class="transaction-id">Deposit - ${transaction.metodePembayaran}</div>
                                <div class="transaction-date">${formattedDate}</div>
                            </div>
                        </div>
                        <div class="transaction-details">
                            <div><strong>Nama:</strong> ${transaction.namaPengirim}</div>
                            <div><strong>No. E-Wallet:</strong> ${transaction.noEwallet}</div>
                            <div><strong>Jumlah:</strong> Rp ${formatRupiah(transaction.jumlah)}</div>
                            ${transaction.catatan !== '-' ? `<div><strong>Catatan:</strong> ${transaction.catatan}</div>` : ''}
                        </div>
                        <div class="transaction-status ${statusClass}">${statusText}</div>
                    `;
                }
                
                container.appendChild(item);
            });
        }
        
        // ==================== FUNGSI ORDER ====================
        
        function selectPriceCard(card, price, packageName, updatesText) {
            document.querySelectorAll('.price-card').forEach(c => {
                c.classList.remove('selected');
            });
            
            if (card) {
                card.classList.add('selected');
                selectedPrice = parseInt(card.getAttribute('data-price'));
                selectedUpdates = card.getAttribute('data-updates');
                selectedPackageName = packageName;
                selectedPackageDisplay = updatesText;
            }
            
            // Reset discount when changing package
            resetDiscount();
            
            updateOrderSummary(selectedPackageName, selectedPrice, selectedUpdates);
        }
        
        function updateOrderSummary(packageName, price, updates, purchaseTime = null) {
            if (packageName && packageName !== '-') {
                document.getElementById('summaryPackage').textContent = packageName;
            }
            
            if (price) {
                const displayPrice = activeDiscount ? discountedPrice : price;
                const discountText = activeDiscount ? ` (Diskon ${activeDiscount.percentage}%)` : '';
                document.getElementById('summaryPrice').textContent = `Rp ${formatRupiah(displayPrice)}${discountText}`;
            }
            
            if (updates) {
                document.getElementById('summaryUpdates').textContent = 
                    updates === 'unlimited' ? 'Unlimited Update' : `${updates} Update`;
            }
            
            // Update package name in summary
            const packageInput = document.getElementById('packageName').value.trim();
            if (packageInput) {
                document.getElementById('summaryPackageName').textContent = packageInput;
            } else {
                document.getElementById('summaryPackageName').textContent = '-';
            }
            
            if (purchaseTime) {
                const date = new Date(purchaseTime);
                document.getElementById('summaryTime').textContent = date.toLocaleDateString('id-ID', {
                    weekday: 'long',
                    day: '2-digit',
                    month: 'long',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            } else {
                document.getElementById('summaryTime').textContent = new Date().toLocaleDateString('id-ID', {
                    weekday: 'long',
                    day: '2-digit',
                    month: 'long',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            }
        }
        
        async function submitOrder() {
            const submitBtn = document.getElementById('submitBtn');
            
            if (!selectedPrice || selectedPrice === 0) {
                showToast('âŒ Pilih paket VIP terlebih dahulu!');
                return;
            }
            
            // Check package name
            const packageNameInput = document.getElementById('packageName').value.trim();
            if (!packageNameInput) {
                showToast('âŒ Masukkan nama package terlebih dahulu! Contoh: com.netease.newspike');
                document.getElementById('packageName').focus();
                return;
            }
            
            // Calculate final price (with discount if applicable)
            const finalPrice = activeDiscount ? discountedPrice : selectedPrice;
            
            if (currentSaldo < finalPrice) {
                showToast(`âŒ Saldo tidak cukup! Saldo Anda: Rp ${formatRupiah(currentSaldo)}, Dibutuhkan: Rp ${formatRupiah(finalPrice)}`);
                showDepositPopup();
                return;
            }
            
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> MEMPROSES...';
            
            try {
                const newSaldo = currentSaldo - finalPrice;
                
                await database.ref('saldo/' + currentUID).update({
                    amount: newSaldo,
                    lastUpdate: firebase.database.ServerValue.TIMESTAMP,
                    lastPurchase: new Date().toISOString()
                });
                
                const purchaseData = {
                    uid: currentUID,
                    price: finalPrice,
                    originalPrice: selectedPrice,
                    packageName: selectedPackageName,
                    packageInput: packageNameInput,
                    updates: selectedUpdates,
                    timestamp: firebase.database.ServerValue.TIMESTAMP,
                    purchaseTime: new Date().toISOString(),
                    status: 'completed',
                    type: 'purchase'
                };
                
                // Add discount info if applied
                if (activeDiscount) {
                    purchaseData.discountCode = activeDiscount.code;
                    purchaseData.discountPercentage = activeDiscount.percentage;
                    purchaseData.discountAmount = activeDiscount.discountAmount;
                }
                
                const purchaseRef = database.ref('purchases/' + currentUID).push();
                await purchaseRef.set(purchaseData);
                
                const updateRef = database.ref('updates/' + currentUID);
                const snapshot = await updateRef.once('value');
                
                if (snapshot.exists()) {
                    const existing = snapshot.val();
                    let newTotal = selectedUpdates;
                    let newRemaining = selectedUpdates;
                    
                    if (existing.total === 'unlimited' || selectedUpdates === 'unlimited') {
                        newTotal = 'unlimited';
                        newRemaining = 'unlimited';
                    } else {
                        newTotal = (parseInt(existing.total) || 0) + parseInt(selectedUpdates);
                        newRemaining = (parseInt(existing.remaining) || 0) + parseInt(selectedUpdates);
                    }
                    
                    await updateRef.update({
                        total: newTotal,
                        remaining: newRemaining,
                        package: selectedPackageName,
                        price: finalPrice,
                        lastUpdate: firebase.database.ServerValue.TIMESTAMP,
                        purchaseTime: new Date().toISOString(),
                        lastPurchaseId: purchaseRef.key
                    });
                } else {
                    await updateRef.set({
                        total: selectedUpdates,
                        remaining: selectedUpdates,
                        used: 0,
                        package: selectedPackageName,
                        price: finalPrice,
                        created: firebase.database.ServerValue.TIMESTAMP,
                        purchaseTime: new Date().toISOString(),
                        lastPurchaseId: purchaseRef.key
                    });
                }
                
                await database.ref('customers/' + currentUID).update({
                    hasPurchase: true,
                    lastPurchase: firebase.database.ServerValue.TIMESTAMP,
                    purchaseCount: firebase.database.ServerValue.increment(1),
                    totalSpent: firebase.database.ServerValue.increment(finalPrice)
                });
                
                // Send detailed message to admin
                const discountText = activeDiscount ? 
                    `\nKode Diskon: ${activeDiscount.code}\nDiskon: ${activeDiscount.percentage}%\nPotongan: Rp ${formatRupiah(activeDiscount.discountAmount)}\nHarga Asli: Rp ${formatRupiah(selectedPrice)}` : '';
                
                const adminMessage = {
                    sender: 'system',
                    text: `ðŸ’° **PEMBELIAN VIP BARU**\n\nUID: ${currentUID}\nPaket: ${selectedPackageName}\nPackage Name: ${packageNameInput}\nHarga: Rp ${formatRupiah(finalPrice)}${discountText}\nUpdate: ${selectedUpdates}\nSaldo Terpotong: Rp ${formatRupiah(finalPrice)}\nSaldo Baru: Rp ${formatRupiah(newSaldo)}\nWaktu: ${new Date().toLocaleString('id-ID')}`,
                    timestamp: new Date().toISOString(),
                    type: 'system',
                    purchaseId: purchaseRef.key
                };
                
                await database.ref('chats/' + currentUID).push(adminMessage);
                
                updateOrderSummary(selectedPackageName, finalPrice, selectedUpdates, new Date());
                
                currentSaldo = newSaldo;
                updateSaldoDisplay();
                
                // Add to transaction gallery
                addToTransactionGallery({
                    ...purchaseData,
                    id: purchaseRef.key
                });
                
                showToast(`âœ… Pembelian berhasil! ${selectedPackageName} telah diaktifkan.`);
                
                // Reset form
                document.querySelectorAll('.price-card').forEach(c => c.classList.remove('selected'));
                selectedPrice = 0;
                selectedUpdates = 0;
                selectedPackageName = '';
                selectedPackageDisplay = '';
                document.getElementById('packageName').value = '';
                resetDiscount();
                
            } catch (error) {
                console.error('Error processing order:', error);
                showToast('âŒ Error: ' + error.message);
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fas fa-shopping-cart"></i> BELI VIP SEKARANG';
            }
        }
        
        function resetForm() {
            document.querySelectorAll('.price-card').forEach(opt => opt.classList.remove('selected'));
            selectedPrice = 0;
            selectedUpdates = 0;
            selectedPackageName = '';
            selectedPackageDisplay = '';
            document.getElementById('packageName').value = '';
            resetDiscount();
            
            updateOrderSummary();
            showToast('Form telah direset');
        }
        
        // ==================== FUNGSI MAINTENANCE ====================
        
        function checkMaintenanceStatus() {
            database.ref('maintenance').once('value')
                .then((snapshot) => {
                    const maintenance = snapshot.val();
                    if (maintenance && maintenance.status === 'active') {
                        showMaintenancePage(maintenance);
                    } else {
                        document.getElementById('maintenancePage').classList.remove('active');
                        
                        if (!currentUID) {
                            document.getElementById('uidPopup').classList.add('active');
                        } else {
                            document.getElementById('mainContainer').style.display = 'flex';
                            document.getElementById('fileGallery').classList.add('active');
                            document.getElementById('transactionGallery').classList.add('active');
                        }
                    }
                })
                .catch((error) => {
                    console.error('Error checking maintenance:', error);
                    document.getElementById('maintenancePage').classList.remove('active');
                    if (!currentUID) {
                        document.getElementById('uidPopup').classList.add('active');
                    } else {
                        document.getElementById('mainContainer').style.display = 'flex';
                        document.getElementById('fileGallery').classList.add('active');
                        document.getElementById('transactionGallery').classList.add('active');
                    }
                });
        }
        
        function showMaintenancePage(maintenance) {
            const maintenancePage = document.getElementById('maintenancePage');
            
            maintenancePage.classList.add('active');
            document.getElementById('mainContainer').style.display = 'none';
            document.getElementById('uidPopup').classList.remove('active');
            document.getElementById('saldoContainer').style.display = 'none';
            document.getElementById('depositPopup').classList.remove('active');
            document.getElementById('adminStatus').style.display = 'none';
            document.getElementById('vipUpdatePopup').classList.remove('active');
            document.getElementById('vipGlobalUpdatePopup').classList.remove('active');
            document.getElementById('fileGallery').classList.remove('active');
            document.getElementById('transactionGallery').classList.remove('active');
            
            document.getElementById('maintenancePageTitle').textContent = maintenance.title || 'MAINTENANCE MODE';
            document.getElementById('maintenancePageMessage').textContent = maintenance.message || 'Sistem VIP Files sedang dalam pemeliharaan. Kami sedang melakukan pembaruan untuk pengalaman yang lebih baik.';
            
            if (maintenance.startTime) {
                maintenanceStartTime = new Date(maintenance.startTime);
                document.getElementById('maintenancePageStartTime').textContent = 
                    maintenanceStartTime.toLocaleString('id-ID', {
                        weekday: 'long',
                        day: '2-digit',
                        month: 'long',
                        year: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
            } else {
                document.getElementById('maintenancePageStartTime').textContent = '-';
            }
            
            if (maintenance.endTime) {
                maintenanceEndTime = new Date(maintenance.endTime);
                document.getElementById('maintenancePageEndTime').textContent = 
                    maintenanceEndTime.toLocaleString('id-ID', {
                        weekday: 'long',
                        day: '2-digit',
                        month: 'long',
                        year: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
            } else {
                document.getElementById('maintenancePageEndTime').textContent = '-';
            }
            
            if (maintenance.totalMinutes) {
                maintenanceTotalDuration = maintenance.totalMinutes * 60 * 1000;
                document.getElementById('maintenancePageDuration').textContent = 
                    formatDuration(maintenance.totalMinutes);
            } else {
                document.getElementById('maintenancePageDuration').textContent = '-';
            }
            
            if (maintenance.additionalMessage) {
                document.getElementById('maintenancePageAdditional').innerHTML = 
                    `<i class="fas fa-clock"></i> ${maintenance.additionalMessage}`;
            } else {
                document.getElementById('maintenancePageAdditional').innerHTML = 
                    `<i class="fas fa-clock"></i> Terima kasih atas kesabaran Anda. Sistem akan kembali normal secepatnya.`;
            }
            
            updateMaintenancePageTimer();
            if (maintenanceTimerInterval) clearInterval(maintenanceTimerInterval);
            maintenanceTimerInterval = setInterval(updateMaintenancePageTimer, 1000);
        }
        
        function updateMaintenancePageTimer() {
            if (!maintenanceEndTime) return;
            
            const now = new Date();
            const remaining = maintenanceEndTime - now;
            
            if (remaining <= 0) {
                document.getElementById('maintenancePageTimer').textContent = '00:00:00';
                document.getElementById('maintenancePageProgressBar').style.width = '100%';
                clearInterval(maintenanceTimerInterval);
                
                showToast('âœ… Maintenance selesai! Halaman akan refresh...');
                setTimeout(() => {
                    location.reload();
                }, 3000);
                return;
            }
            
            const hours = Math.floor(remaining / (1000 * 60 * 60));
            const minutes = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((remaining % (1000 * 60)) / 1000);
            
            document.getElementById('maintenancePageTimer').textContent = 
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            if (maintenanceTotalDuration > 0) {
                const elapsed = maintenanceTotalDuration - remaining;
                const progress = (elapsed / maintenanceTotalDuration) * 100;
                document.getElementById('maintenancePageProgressBar').style.width = `${Math.min(progress, 100)}%`;
            }
        }
        
        function formatDuration(minutes) {
            const hours = Math.floor(minutes / 60);
            const mins = minutes % 60;
            const days = Math.floor(hours / 24);
            const hrs = hours % 24;
            
            let result = [];
            if (days > 0) result.push(`${days} Hari`);
            if (hrs > 0) result.push(`${hrs} Jam`);
            if (mins > 0) result.push(`${mins} Menit`);
            
            return result.join(' ') || '0 Menit';
        }
        
        // ==================== FUNGSI HELPER ====================
        
        function copyToClipboard(text, type = 'Teks') {
            if (!text) {
                showToast('Tidak ada teks untuk disalin');
                return;
            }
            
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(text).then(() => {
                    showToast(`âœ… ${type} berhasil disalin!`);
                }).catch(err => {
                    fallbackCopyTextToClipboard(text, type);
                });
            } else {
                fallbackCopyTextToClipboard(text, type);
            }
        }
        
        function fallbackCopyTextToClipboard(text, type) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.top = "0";
            textArea.style.left = "0";
            textArea.style.position = "fixed";
            textArea.style.opacity = "0";
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    showToast(`âœ… ${type} berhasil disalin!`);
                } else {
                    showToast(`âŒ Gagal menyalin ${type}, silakan salin manual`);
                }
            } catch (err) {
                console.error('Fallback copy error:', err);
                showToast(`âŒ Gagal menyalin ${type}, silakan salin manual`);
            }
            
            document.body.removeChild(textArea);
        }
        
        function copyUidToClipboard() {
            if (!currentUID) {
                showToast('UID belum tersedia');
                return;
            }
            
            copyToClipboard(currentUID, 'UID');
        }
        
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        function showError(elementId, message) {
            const element = document.getElementById(elementId);
            if (element) {
                element.innerHTML = `<i class="fas fa-exclamation-circle"></i> ${message}`;
                element.style.display = 'block';
            }
        }
        
        function hideError(elementId) {
            const element = document.getElementById(elementId);
            if (element) {
                element.style.display = 'none';
            }
        }
        
        function showSuccess(elementId, message) {
            const element = document.getElementById(elementId);
            if (element) {
                element.innerHTML = `<i class="fas fa-check-circle"></i> ${message}`;
                element.style.display = 'block';
            }
        }
        
        function hideSuccess(elementId) {
            const element = document.getElementById(elementId);
            if (element) {
                element.style.display = 'none';
            }
        }
    </script>
</body>
</html>